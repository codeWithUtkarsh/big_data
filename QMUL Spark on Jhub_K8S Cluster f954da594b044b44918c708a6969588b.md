# QMUL Spark on Jhub_K8S Cluster

QMUL Spark on Jhub/K8S Cluster

[data:image/svg+xml;base64,PHN2ZyByb2xlPSJncmFwaGljcy1zeW1ib2wiIHZpZXdib3g9IjAgMCAxNiAxNiIgY2xhc3M9InNlYXJjaCIgc3R5bGU9IndpZHRoOiAxNHB4OyBoZWlnaHQ6IDE0cHg7IGRpc3BsYXk6IGJsb2NrOyBmaWxsOiBpbmhlcml0OyBmbGV4LXNocmluazogMDsiPjxwYXRoIGQ9Ik0uMjgxIDYuNDM4YzAtLjg3NS4xNjQtMS42OTYuNDkyLTIuNDYxYTYuNDg0IDYuNDg0IDAgMDExLjM3NS0yLjAzMkE2LjIzNyA2LjIzNyAwIDAxNi42NC4wNzggNi4yIDYuMiAwIDAxOS4xMS41N2MuNzcuMzI4IDEuNDQ3Ljc4NyAyLjAzIDEuMzc1YTYuMzc0IDYuMzc0IDAgMDExLjM2OCAyLjAzMmMuMzMzLjc2NS41IDEuNTg2LjUgMi40NiAwIC42ODgtLjEwNyAxLjM0Mi0uMzIgMS45NjFhNi4yOCA2LjI4IDAgMDEtLjg2OCAxLjY5NmwzLjU2MyAzLjU3OGMuMTEuMTA0LjE5LjIyNi4yNDIuMzY3LjA1Ny4xNC4wODYuMjkuMDg2LjQ0NSAwIC4yMi0uMDUuNDE3LS4xNDkuNTk0YTEuMTIyIDEuMTIyIDAgMDEtMSAuNTdjLS4xNTYgMC0uMzA3LS4wMjgtLjQ1My0uMDg2YTEuMDU4IDEuMDU4IDAgMDEtLjM4Mi0uMjVsLTMuNTg2LTMuNTg1Yy0uNS4zMzMtMS4wNDcuNTk2LTEuNjQxLjc4OWE2LjA4OSA2LjA4OSAwIDAxLTEuODYuMjggNi4yMzcgNi4yMzcgMCAwMS0yLjQ2OC0uNDkxIDYuNCA2LjQgMCAwMS0yLjAyNC0xLjM2N0E2LjUwOSA2LjUwOSAwIDAxLjc3MyA4LjkxM2E2LjI1NiA2LjI1NiAwIDAxLS40OTItMi40NzZ6bTEuNjY0IDBjMCAuNjUuMTIgMS4yNi4zNiAxLjgyOGE0Ljc3NSA0Ljc3NSAwIDAwMS4wMTUgMS41Yy40MzMuNDI3LjkzMy43NjMgMS41IDEuMDA3YTQuNTQ4IDQuNTQ4IDAgMDAxLjgyLjM2OGMuNjUyIDAgMS4yNjEtLjEyMyAxLjgyOS0uMzY4YTQuNzQ3IDQuNzQ3IDAgMDAyLjUwOC0yLjUwNyA0LjU2NyA0LjU2NyAwIDAwLjM2Ny0xLjgyOWMwLS42NDUtLjEyMy0xLjI1Mi0uMzY3LTEuODJhNC43NzYgNC43NzYgMCAwMC0xLjAxNi0xLjVBNC41NzggNC41NzggMCAwMDguNDY5IDIuMTFhNC41NjcgNC41NjcgMCAwMC0xLjgyOC0uMzY3Yy0uNjQ2IDAtMS4yNTMuMTIzLTEuODIuMzY3YTQuNjY3IDQuNjY3IDAgMDAtMS41IDEuMDA4Yy0uNDMzLjQzMi0uNzcyLjkzMi0xLjAxNiAxLjVhNC42MzMgNC42MzMgMCAwMC0uMzYgMS44MnoiIC8+PC9zdmc+](data:image/svg+xml;base64,PHN2ZyByb2xlPSJncmFwaGljcy1zeW1ib2wiIHZpZXdib3g9IjAgMCAxNiAxNiIgY2xhc3M9InNlYXJjaCIgc3R5bGU9IndpZHRoOiAxNHB4OyBoZWlnaHQ6IDE0cHg7IGRpc3BsYXk6IGJsb2NrOyBmaWxsOiBpbmhlcml0OyBmbGV4LXNocmluazogMDsiPjxwYXRoIGQ9Ik0uMjgxIDYuNDM4YzAtLjg3NS4xNjQtMS42OTYuNDkyLTIuNDYxYTYuNDg0IDYuNDg0IDAgMDExLjM3NS0yLjAzMkE2LjIzNyA2LjIzNyAwIDAxNi42NC4wNzggNi4yIDYuMiAwIDAxOS4xMS41N2MuNzcuMzI4IDEuNDQ3Ljc4NyAyLjAzIDEuMzc1YTYuMzc0IDYuMzc0IDAgMDExLjM2OCAyLjAzMmMuMzMzLjc2NS41IDEuNTg2LjUgMi40NiAwIC42ODgtLjEwNyAxLjM0Mi0uMzIgMS45NjFhNi4yOCA2LjI4IDAgMDEtLjg2OCAxLjY5NmwzLjU2MyAzLjU3OGMuMTEuMTA0LjE5LjIyNi4yNDIuMzY3LjA1Ny4xNC4wODYuMjkuMDg2LjQ0NSAwIC4yMi0uMDUuNDE3LS4xNDkuNTk0YTEuMTIyIDEuMTIyIDAgMDEtMSAuNTdjLS4xNTYgMC0uMzA3LS4wMjgtLjQ1My0uMDg2YTEuMDU4IDEuMDU4IDAgMDEtLjM4Mi0uMjVsLTMuNTg2LTMuNTg1Yy0uNS4zMzMtMS4wNDcuNTk2LTEuNjQxLjc4OWE2LjA4OSA2LjA4OSAwIDAxLTEuODYuMjggNi4yMzcgNi4yMzcgMCAwMS0yLjQ2OC0uNDkxIDYuNCA2LjQgMCAwMS0yLjAyNC0xLjM2N0E2LjUwOSA2LjUwOSAwIDAxLjc3MyA4LjkxM2E2LjI1NiA2LjI1NiAwIDAxLS40OTItMi40NzZ6bTEuNjY0IDBjMCAuNjUuMTIgMS4yNi4zNiAxLjgyOGE0Ljc3NSA0Ljc3NSAwIDAwMS4wMTUgMS41Yy40MzMuNDI3LjkzMy43NjMgMS41IDEuMDA3YTQuNTQ4IDQuNTQ4IDAgMDAxLjgyLjM2OGMuNjUyIDAgMS4yNjEtLjEyMyAxLjgyOS0uMzY4YTQuNzQ3IDQuNzQ3IDAgMDAyLjUwOC0yLjUwNyA0LjU2NyA0LjU2NyAwIDAwLjM2Ny0xLjgyOWMwLS42NDUtLjEyMy0xLjI1Mi0uMzY3LTEuODJhNC43NzYgNC43NzYgMCAwMC0xLjAxNi0xLjVBNC41NzggNC41NzggMCAwMDguNDY5IDIuMTFhNC41NjcgNC41NjcgMCAwMC0xLjgyOC0uMzY3Yy0uNjQ2IDAtMS4yNTMuMTIzLTEuODIuMzY3YTQuNjY3IDQuNjY3IDAgMDAtMS41IDEuMDA4Yy0uNDMzLjQzMi0uNzcyLjkzMi0xLjAxNiAxLjVhNC42MzMgNC42MzMgMCAwMC0uMzYgMS44MnoiIC8+PC9zdmc+)

[data:image/svg+xml;base64,PHN2ZyByb2xlPSJncmFwaGljcy1zeW1ib2wiIHZpZXdib3g9IjAgMCAxNiAxNiIgY2xhc3M9ImVsbGlwc2lzIiBzdHlsZT0id2lkdGg6IDE4cHg7IGhlaWdodDogMThweDsgZGlzcGxheTogYmxvY2s7IGZpbGw6IGluaGVyaXQ7IGZsZXgtc2hyaW5rOiAwOyI+PHBhdGggZD0iTTIuODg3IDkuMDE0Yy4yNzMgMCAuNTItLjA2NC43MzgtLjE5Mi4yMTktLjEzMi4zOTQtLjMwNy41MjYtLjUyNi4xMzMtLjIxOS4xOTktLjQ2LjE5OS0uNzI1IDAtLjQwNS0uMTQyLS43NDctLjQyNC0xLjAyNWExLjQxIDEuNDEgMCAwMC0xLjA0LS40MTdjLS4yNjQgMC0uNTA1LjA2Ni0uNzI0LjE5OGExLjQxMiAxLjQxMiAwIDAwLS43MTggMS4yNDRjMCAuMjY1LjA2NC41MDYuMTkyLjcyNS4xMzIuMjE5LjMwNy4zOTQuNTI2LjUyNi4yMTkuMTI4LjQ2LjE5Mi43MjUuMTkyem01LjExMyAwYTEuNDEyIDEuNDEyIDAgMDAxLjI0NC0uNzE4Yy4xMzItLjIxOS4xOTgtLjQ2LjE5OC0uNzI1IDAtLjQwNS0uMTQtLjc0Ny0uNDIzLTEuMDI1QTEuMzg2IDEuMzg2IDAgMDA4IDYuMTI5Yy0uMjY0IDAtLjUwNi4wNjYtLjcyNS4xOThhMS40MTIgMS40MTIgMCAwMC0uNzE4IDEuMjQ0YzAgLjI2NS4wNjQuNTA2LjE5Mi43MjUuMTMyLjIxOS4zMDguMzk0LjUyNi41MjYuMjIuMTI4LjQ2LjE5Mi43MjUuMTkyem01LjEwNiAwYy4yNjUgMCAuNTA2LS4wNjQuNzI1LS4xOTIuMjE5LS4xMzIuMzk0LS4zMDcuNTI2LS41MjYuMTMzLS4yMTkuMTk5LS40Ni4xOTktLjcyNSAwLS40MDUtLjE0Mi0uNzQ3LS40MjQtMS4wMjVhMS4zOTQgMS4zOTQgMCAwMC0xLjAyNi0uNDE3IDEuNDc0IDEuNDc0IDAgMDAtMS4yNjUuNzE4Yy0uMTI3LjIxOC0uMTkuNDYtLjE5LjcyNCAwIC4yNjUuMDYzLjUwNi4xOS43MjUuMTMzLjIxOS4zMDguMzk0LjUyNy41MjYuMjIzLjEyOC40Ny4xOTIuNzM4LjE5MnoiIC8+PC9zdmc+](data:image/svg+xml;base64,PHN2ZyByb2xlPSJncmFwaGljcy1zeW1ib2wiIHZpZXdib3g9IjAgMCAxNiAxNiIgY2xhc3M9ImVsbGlwc2lzIiBzdHlsZT0id2lkdGg6IDE4cHg7IGhlaWdodDogMThweDsgZGlzcGxheTogYmxvY2s7IGZpbGw6IGluaGVyaXQ7IGZsZXgtc2hyaW5rOiAwOyI+PHBhdGggZD0iTTIuODg3IDkuMDE0Yy4yNzMgMCAuNTItLjA2NC43MzgtLjE5Mi4yMTktLjEzMi4zOTQtLjMwNy41MjYtLjUyNi4xMzMtLjIxOS4xOTktLjQ2LjE5OS0uNzI1IDAtLjQwNS0uMTQyLS43NDctLjQyNC0xLjAyNWExLjQxIDEuNDEgMCAwMC0xLjA0LS40MTdjLS4yNjQgMC0uNTA1LjA2Ni0uNzI0LjE5OGExLjQxMiAxLjQxMiAwIDAwLS43MTggMS4yNDRjMCAuMjY1LjA2NC41MDYuMTkyLjcyNS4xMzIuMjE5LjMwNy4zOTQuNTI2LjUyNi4yMTkuMTI4LjQ2LjE5Mi43MjUuMTkyem01LjExMyAwYTEuNDEyIDEuNDEyIDAgMDAxLjI0NC0uNzE4Yy4xMzItLjIxOS4xOTgtLjQ2LjE5OC0uNzI1IDAtLjQwNS0uMTQtLjc0Ny0uNDIzLTEuMDI1QTEuMzg2IDEuMzg2IDAgMDA4IDYuMTI5Yy0uMjY0IDAtLjUwNi4wNjYtLjcyNS4xOThhMS40MTIgMS40MTIgMCAwMC0uNzE4IDEuMjQ0YzAgLjI2NS4wNjQuNTA2LjE5Mi43MjUuMTMyLjIxOS4zMDguMzk0LjUyNi41MjYuMjIuMTI4LjQ2LjE5Mi43MjUuMTkyem01LjEwNiAwYy4yNjUgMCAuNTA2LS4wNjQuNzI1LS4xOTIuMjE5LS4xMzIuMzk0LS4zMDcuNTI2LS41MjYuMTMzLS4yMTkuMTk5LS40Ni4xOTktLjcyNSAwLS40MDUtLjE0Mi0uNzQ3LS40MjQtMS4wMjVhMS4zOTQgMS4zOTQgMCAwMC0xLjAyNi0uNDE3IDEuNDc0IDEuNDc0IDAgMDAtMS4yNjUuNzE4Yy0uMTI3LjIxOC0uMTkuNDYtLjE5LjcyNCAwIC4yNjUuMDYzLjUwNi4xOS43MjUuMTMzLjIxOS4zMDguMzk0LjUyNy41MjYuMjIzLjEyOC40Ny4xOTIuNzM4LjE5MnoiIC8+PC9zdmc+)

Built with

[data:image/svg+xml;base64,PHN2ZyByb2xlPSJncmFwaGljcy1zeW1ib2wiIHZpZXdib3g9IjAgMCAxMjAgMTI2IiBjbGFzcz0ibm90aW9uTG9nbyIgc3R5bGU9IndpZHRoOiAxNHB4OyBoZWlnaHQ6IDE0cHg7IGRpc3BsYXk6IGJsb2NrOyBmaWxsOiBpbmhlcml0OyBmbGV4LXNocmluazogMDsgbWFyZ2luLWxlZnQ6IDZweDsiPjxwYXRoIGQ9Ik0gMjAuNjkyNyAyMS45MzE1QyAyNC41ODM2IDI1LjA5MjQgMjYuMDQzMiAyNC44NTEyIDMzLjM0OTIgMjQuMzYzOEwgMTAyLjIyOCAyMC4yMjc5QyAxMDMuNjg5IDIwLjIyNzkgMTAyLjQ3NCAxOC43NzA1IDEwMS45ODcgMTguNTI4M0wgOTAuNTQ3NyAxMC4yNTg2QyA4OC4zNTU4IDguNTU2OTkgODUuNDM1NiA2LjYwODE4IDc5LjgzODcgNy4wOTU2M0wgMTMuMTQzMyAxMS45NjAyQyAxMC43MTEgMTIuMjAxNCAxMC4yMjUxIDEzLjQxNzUgMTEuMTkzOSAxNC4zOTI0TCAyMC42OTI3IDIxLjkzMTVaTSAyNC44MjgxIDM3Ljk4MzVMIDI0LjgyODEgMTEwLjQ1NkMgMjQuODI4MSAxMTQuMzUxIDI2Ljc3NDUgMTE1LjgwOCAzMS4xNTUzIDExNS41NjdMIDEwNi44NTMgMTExLjE4N0MgMTExLjIzNiAxMTAuOTQ2IDExMS43MjQgMTA4LjI2NyAxMTEuNzI0IDEwNS4xMDNMIDExMS43MjQgMzMuMTE2OUMgMTExLjcyNCAyOS45NTggMTEwLjUwOSAyOC4yNTQ0IDEwNy44MjYgMjguNDk3NkwgMjguNzIxIDMzLjExNjlDIDI1LjgwMTggMzMuMzYyMiAyNC44MjgxIDM0LjgyMjUgMjQuODI4MSAzNy45ODM1Wk0gOTkuNTU2NyA0MS44NzExQyAxMDAuMDQyIDQ0LjA2MjIgOTkuNTU2NyA0Ni4yNTEyIDk3LjM2MTggNDYuNDk3NEwgOTMuNzE0MyA0Ny4yMjQxTCA5My43MTQzIDEwMC43MjhDIDkwLjU0NzcgMTAyLjQzIDg3LjYyNzUgMTAzLjQwMyA4NS4xOTQyIDEwMy40MDNDIDgxLjI5ODMgMTAzLjQwMyA4MC4zMjI2IDEwMi4xODYgNzcuNDA0NCA5OC41NEwgNTMuNTQ3MSA2MS4wODdMIDUzLjU0NzEgOTcuMzIzOUwgNjEuMDk2NCA5OS4wMjc1QyA2MS4wOTY0IDk5LjAyNzUgNjEuMDk2NCAxMDMuNDAzIDU1LjAwNTcgMTAzLjQwM0wgMzguMjE0OCAxMDQuMzc3QyAzNy43MjcgMTAzLjQwMyAzOC4yMTQ4IDEwMC45NzMgMzkuOTE3OSAxMDAuNDg2TCA0NC4yOTk2IDk5LjI3MTdMIDQ0LjI5OTYgNTEuMzZMIDM4LjIxNTggNTAuODcyNUMgMzcuNzI4IDQ4LjY4MTUgMzguOTQzMSA0NS41MjI1IDQyLjM1MzIgNDUuMjc3M0wgNjAuMzY2MSA0NC4wNjMxTCA4NS4xOTQyIDgyLjAwMzZMIDg1LjE5NDIgNDguNDQwMkwgNzguODY0IDQ3LjcxMzZDIDc4LjM3ODEgNDUuMDM1MSA4MC4zMjI2IDQzLjA5MDIgODIuNzU2OSA0Mi44NDlMIDk5LjU1NjcgNDEuODcxMVpNIDcuNTQzNCA1LjM5NDA0TCA3Ni45MTc1IDAuMjg1Mjc2QyA4NS40MzY2IC0wLjQ0NTQwMiA4Ny42Mjg1IDAuMDQ0MDQyOCA5Mi45ODMgMy45MzM2OEwgMTE1LjEyOCAxOS40OTgyQyAxMTguNzgyIDIyLjE3NDcgMTIwIDIyLjkwMzQgMTIwIDI1LjgyMTFMIDEyMCAxMTEuMTg3QyAxMjAgMTE2LjUzNyAxMTguMDUxIDExOS43MDEgMTExLjIzNyAxMjAuMTg1TCAzMC42NzM0IDEyNS4wNUMgMjUuNTU4NCAxMjUuMjk0IDIzLjEyNCAxMjQuNTY1IDIwLjQ0NTMgMTIxLjE1OEwgNC4xMzczNSA5OS45OTk0QyAxLjIxNTE2IDk2LjEwNDggMCA5My4xOTEgMCA4OS43ODE5TCAwIDEzLjkwM0MgMCA5LjUyNzkgMS45NDk0NSA1Ljg3ODUgNy41NDM0IDUuMzk0MDRaIiAvPjwvc3ZnPg==](data:image/svg+xml;base64,PHN2ZyByb2xlPSJncmFwaGljcy1zeW1ib2wiIHZpZXdib3g9IjAgMCAxMjAgMTI2IiBjbGFzcz0ibm90aW9uTG9nbyIgc3R5bGU9IndpZHRoOiAxNHB4OyBoZWlnaHQ6IDE0cHg7IGRpc3BsYXk6IGJsb2NrOyBmaWxsOiBpbmhlcml0OyBmbGV4LXNocmluazogMDsgbWFyZ2luLWxlZnQ6IDZweDsiPjxwYXRoIGQ9Ik0gMjAuNjkyNyAyMS45MzE1QyAyNC41ODM2IDI1LjA5MjQgMjYuMDQzMiAyNC44NTEyIDMzLjM0OTIgMjQuMzYzOEwgMTAyLjIyOCAyMC4yMjc5QyAxMDMuNjg5IDIwLjIyNzkgMTAyLjQ3NCAxOC43NzA1IDEwMS45ODcgMTguNTI4M0wgOTAuNTQ3NyAxMC4yNTg2QyA4OC4zNTU4IDguNTU2OTkgODUuNDM1NiA2LjYwODE4IDc5LjgzODcgNy4wOTU2M0wgMTMuMTQzMyAxMS45NjAyQyAxMC43MTEgMTIuMjAxNCAxMC4yMjUxIDEzLjQxNzUgMTEuMTkzOSAxNC4zOTI0TCAyMC42OTI3IDIxLjkzMTVaTSAyNC44MjgxIDM3Ljk4MzVMIDI0LjgyODEgMTEwLjQ1NkMgMjQuODI4MSAxMTQuMzUxIDI2Ljc3NDUgMTE1LjgwOCAzMS4xNTUzIDExNS41NjdMIDEwNi44NTMgMTExLjE4N0MgMTExLjIzNiAxMTAuOTQ2IDExMS43MjQgMTA4LjI2NyAxMTEuNzI0IDEwNS4xMDNMIDExMS43MjQgMzMuMTE2OUMgMTExLjcyNCAyOS45NTggMTEwLjUwOSAyOC4yNTQ0IDEwNy44MjYgMjguNDk3NkwgMjguNzIxIDMzLjExNjlDIDI1LjgwMTggMzMuMzYyMiAyNC44MjgxIDM0LjgyMjUgMjQuODI4MSAzNy45ODM1Wk0gOTkuNTU2NyA0MS44NzExQyAxMDAuMDQyIDQ0LjA2MjIgOTkuNTU2NyA0Ni4yNTEyIDk3LjM2MTggNDYuNDk3NEwgOTMuNzE0MyA0Ny4yMjQxTCA5My43MTQzIDEwMC43MjhDIDkwLjU0NzcgMTAyLjQzIDg3LjYyNzUgMTAzLjQwMyA4NS4xOTQyIDEwMy40MDNDIDgxLjI5ODMgMTAzLjQwMyA4MC4zMjI2IDEwMi4xODYgNzcuNDA0NCA5OC41NEwgNTMuNTQ3MSA2MS4wODdMIDUzLjU0NzEgOTcuMzIzOUwgNjEuMDk2NCA5OS4wMjc1QyA2MS4wOTY0IDk5LjAyNzUgNjEuMDk2NCAxMDMuNDAzIDU1LjAwNTcgMTAzLjQwM0wgMzguMjE0OCAxMDQuMzc3QyAzNy43MjcgMTAzLjQwMyAzOC4yMTQ4IDEwMC45NzMgMzkuOTE3OSAxMDAuNDg2TCA0NC4yOTk2IDk5LjI3MTdMIDQ0LjI5OTYgNTEuMzZMIDM4LjIxNTggNTAuODcyNUMgMzcuNzI4IDQ4LjY4MTUgMzguOTQzMSA0NS41MjI1IDQyLjM1MzIgNDUuMjc3M0wgNjAuMzY2MSA0NC4wNjMxTCA4NS4xOTQyIDgyLjAwMzZMIDg1LjE5NDIgNDguNDQwMkwgNzguODY0IDQ3LjcxMzZDIDc4LjM3ODEgNDUuMDM1MSA4MC4zMjI2IDQzLjA5MDIgODIuNzU2OSA0Mi44NDlMIDk5LjU1NjcgNDEuODcxMVpNIDcuNTQzNCA1LjM5NDA0TCA3Ni45MTc1IDAuMjg1Mjc2QyA4NS40MzY2IC0wLjQ0NTQwMiA4Ny42Mjg1IDAuMDQ0MDQyOCA5Mi45ODMgMy45MzM2OEwgMTE1LjEyOCAxOS40OTgyQyAxMTguNzgyIDIyLjE3NDcgMTIwIDIyLjkwMzQgMTIwIDI1LjgyMTFMIDEyMCAxMTEuMTg3QyAxMjAgMTE2LjUzNyAxMTguMDUxIDExOS43MDEgMTExLjIzNyAxMjAuMTg1TCAzMC42NzM0IDEyNS4wNUMgMjUuNTU4NCAxMjUuMjk0IDIzLjEyNCAxMjQuNTY1IDIwLjQ0NTMgMTIxLjE1OEwgNC4xMzczNSA5OS45OTk0QyAxLjIxNTE2IDk2LjEwNDggMCA5My4xOTEgMCA4OS43ODE5TCAwIDEzLjkwM0MgMCA5LjUyNzkgMS45NDk0NSA1Ljg3ODUgNy41NDM0IDUuMzk0MDRaIiAvPjwvc3ZnPg==)

# QMUL Spark on Jhub/K8S Cluster

The link for accessing the token server which is used to log in to the
OpenShift services on the computing environment.

[https://oauth-openshift.apps.a.comp-teach.qmul.ac.uk/oauth/token/request](https://oauth-openshift.apps.a.comp-teach.qmul.ac.uk/oauth/token/request)

You need to go to this link and log in with your QMUL credentials (using
KeyCloak) then click on the display token link. Then, copy the line
oc
login --token=XXXX --server=https://api.a.comp-teach.qmul.ac.uk:6443
and paste it in the terminal then press enter to login

Submitting and running using a python source file

Bash

[data:image/svg+xml;base64,PHN2ZyByb2xlPSJncmFwaGljcy1zeW1ib2wiIHZpZXdib3g9IjAgMCAxNCAxNiIgY2xhc3M9ImNvcHkiIHN0eWxlPSJ3aWR0aDogMTZweDsgaGVpZ2h0OiAxNnB4OyBkaXNwbGF5OiBibG9jazsgZmlsbDogaW5oZXJpdDsgZmxleC1zaHJpbms6IDA7IHBhZGRpbmctcmlnaHQ6IDRweDsiPjxwYXRoIGQ9Ik0yLjQwNCAxNS4zMjJoNS43MDFjMS4yNiAwIDEuODg3LS42NjIgMS44ODctMS45MjdWMTIuMzhoMS4xNTRjMS4yNTQgMCAxLjkxLS42NjIgMS45MS0xLjkyOFY1LjU1NWMwLS43NzQtLjE1OC0xLjI2Ni0uNjI2LTEuNzRMOS41MTIuODM3QzkuMDY2LjM4NyA4LjU0NS4yMSA3Ljg2NS4yMUg1LjQ2M2MtMS4yNTQgMC0xLjkxLjY2Mi0xLjkxIDEuOTI4djEuMDg0SDIuNDA0Yy0xLjI1NCAwLTEuOTEuNjY4LTEuOTEgMS45MzN2OC4yMzljMCAxLjI2NS42NTYgMS45MjcgMS45MSAxLjkyN3ptNy41ODgtNi42MmMwLS43OTItLjEtMS4xNjEtLjU5Mi0xLjY2NUw2LjIyNSAzLjgxNGMtLjQ1Mi0uNDYyLS44NDQtLjU4LTEuNS0uNTkxVjIuMjE1YzAtLjUzMy4yOC0uODMyLjg0My0uODMyaDIuMzh2Mi44ODNjMCAuNzI2LjM4NiAxLjExMyAxLjEwNyAxLjExM2gyLjgzdjQuOTk4YzAgLjUzOS0uMjc2LjgzMi0uODQ0LjgzMkg5Ljk5MlY4LjcwMXptLS43OS00LjI5Yy0uMjA2IDAtLjI4OC0uMDg4LS4yODgtLjI4N1YxLjU5NGwyLjc3MSAyLjgxOEg5LjIwMXpNMi41MDMgMTQuMTVjLS41NjMgMC0uODQ0LS4yOTMtLjg0NC0uODMyVjUuMjMyYzAtLjUzOS4yODEtLjgzNy44NS0uODM3aDEuOTF2My4xODdjMCAuODUuNDE2IDEuMjYgMS4yNiAxLjI2aDMuMTR2NC40NzZjMCAuNTQtLjI4LjgzMi0uODQzLjgzMkgyLjUwNHpNNS43OSA3LjgxNmMtLjI0IDAtLjM0Ni0uMTA1LS4zNDYtLjM0NVY0LjU0N2wzLjIyMyAzLjI3SDUuNzkxeiIgLz48L3N2Zz4=](data:image/svg+xml;base64,PHN2ZyByb2xlPSJncmFwaGljcy1zeW1ib2wiIHZpZXdib3g9IjAgMCAxNCAxNiIgY2xhc3M9ImNvcHkiIHN0eWxlPSJ3aWR0aDogMTZweDsgaGVpZ2h0OiAxNnB4OyBkaXNwbGF5OiBibG9jazsgZmlsbDogaW5oZXJpdDsgZmxleC1zaHJpbms6IDA7IHBhZGRpbmctcmlnaHQ6IDRweDsiPjxwYXRoIGQ9Ik0yLjQwNCAxNS4zMjJoNS43MDFjMS4yNiAwIDEuODg3LS42NjIgMS44ODctMS45MjdWMTIuMzhoMS4xNTRjMS4yNTQgMCAxLjkxLS42NjIgMS45MS0xLjkyOFY1LjU1NWMwLS43NzQtLjE1OC0xLjI2Ni0uNjI2LTEuNzRMOS41MTIuODM3QzkuMDY2LjM4NyA4LjU0NS4yMSA3Ljg2NS4yMUg1LjQ2M2MtMS4yNTQgMC0xLjkxLjY2Mi0xLjkxIDEuOTI4djEuMDg0SDIuNDA0Yy0xLjI1NCAwLTEuOTEuNjY4LTEuOTEgMS45MzN2OC4yMzljMCAxLjI2NS42NTYgMS45MjcgMS45MSAxLjkyN3ptNy41ODgtNi42MmMwLS43OTItLjEtMS4xNjEtLjU5Mi0xLjY2NUw2LjIyNSAzLjgxNGMtLjQ1Mi0uNDYyLS44NDQtLjU4LTEuNS0uNTkxVjIuMjE1YzAtLjUzMy4yOC0uODMyLjg0My0uODMyaDIuMzh2Mi44ODNjMCAuNzI2LjM4NiAxLjExMyAxLjEwNyAxLjExM2gyLjgzdjQuOTk4YzAgLjUzOS0uMjc2LjgzMi0uODQ0LjgzMkg5Ljk5MlY4LjcwMXptLS43OS00LjI5Yy0uMjA2IDAtLjI4OC0uMDg4LS4yODgtLjI4N1YxLjU5NGwyLjc3MSAyLjgxOEg5LjIwMXpNMi41MDMgMTQuMTVjLS41NjMgMC0uODQ0LS4yOTMtLjg0NC0uODMyVjUuMjMyYzAtLjUzOS4yODEtLjgzNy44NS0uODM3aDEuOTF2My4xODdjMCAuODUuNDE2IDEuMjYgMS4yNiAxLjI2aDMuMTR2NC40NzZjMCAuNTQtLjI4LjgzMi0uODQzLjgzMkgyLjUwNHpNNS43OSA3LjgxNmMtLjI0IDAtLjM0Ni0uMTA1LS4zNDYtLjM0NVY0LjU0N2wzLjIyMyAzLjI3SDUuNzkxeiIgLz48L3N2Zz4=)

Copy

ccc create spark wordcount.py -s Flags: -n,
--name Spark application name, defaults to Python file name -e, --exec Number of executor instances,
defaults to 2 -d, --dyn
Enable dynamically allocated executor instances, defaults to
false -c, --cores
Number of cores per executor, defaults to 1 -s, --submit Auto submit Spark job, defaults to
false -r,
--remove Remove generated yaml object files when auto submit is true,
defaults to false

​

Create the job app and config files and submit the task

Bash

[data:image/svg+xml;base64,PHN2ZyByb2xlPSJncmFwaGljcy1zeW1ib2wiIHZpZXdib3g9IjAgMCAxNCAxNiIgY2xhc3M9ImNvcHkiIHN0eWxlPSJ3aWR0aDogMTZweDsgaGVpZ2h0OiAxNnB4OyBkaXNwbGF5OiBibG9jazsgZmlsbDogaW5oZXJpdDsgZmxleC1zaHJpbms6IDA7IHBhZGRpbmctcmlnaHQ6IDRweDsiPjxwYXRoIGQ9Ik0yLjQwNCAxNS4zMjJoNS43MDFjMS4yNiAwIDEuODg3LS42NjIgMS44ODctMS45MjdWMTIuMzhoMS4xNTRjMS4yNTQgMCAxLjkxLS42NjIgMS45MS0xLjkyOFY1LjU1NWMwLS43NzQtLjE1OC0xLjI2Ni0uNjI2LTEuNzRMOS41MTIuODM3QzkuMDY2LjM4NyA4LjU0NS4yMSA3Ljg2NS4yMUg1LjQ2M2MtMS4yNTQgMC0xLjkxLjY2Mi0xLjkxIDEuOTI4djEuMDg0SDIuNDA0Yy0xLjI1NCAwLTEuOTEuNjY4LTEuOTEgMS45MzN2OC4yMzljMCAxLjI2NS42NTYgMS45MjcgMS45MSAxLjkyN3ptNy41ODgtNi42MmMwLS43OTItLjEtMS4xNjEtLjU5Mi0xLjY2NUw2LjIyNSAzLjgxNGMtLjQ1Mi0uNDYyLS44NDQtLjU4LTEuNS0uNTkxVjIuMjE1YzAtLjUzMy4yOC0uODMyLjg0My0uODMyaDIuMzh2Mi44ODNjMCAuNzI2LjM4NiAxLjExMyAxLjEwNyAxLjExM2gyLjgzdjQuOTk4YzAgLjUzOS0uMjc2LjgzMi0uODQ0LjgzMkg5Ljk5MlY4LjcwMXptLS43OS00LjI5Yy0uMjA2IDAtLjI4OC0uMDg4LS4yODgtLjI4N1YxLjU5NGwyLjc3MSAyLjgxOEg5LjIwMXpNMi41MDMgMTQuMTVjLS41NjMgMC0uODQ0LS4yOTMtLjg0NC0uODMyVjUuMjMyYzAtLjUzOS4yODEtLjgzNy44NS0uODM3aDEuOTF2My4xODdjMCAuODUuNDE2IDEuMjYgMS4yNiAxLjI2aDMuMTR2NC40NzZjMCAuNTQtLjI4LjgzMi0uODQzLjgzMkgyLjUwNHpNNS43OSA3LjgxNmMtLjI0IDAtLjM0Ni0uMTA1LS4zNDYtLjM0NVY0LjU0N2wzLjIyMyAzLjI3SDUuNzkxeiIgLz48L3N2Zz4=](data:image/svg+xml;base64,PHN2ZyByb2xlPSJncmFwaGljcy1zeW1ib2wiIHZpZXdib3g9IjAgMCAxNCAxNiIgY2xhc3M9ImNvcHkiIHN0eWxlPSJ3aWR0aDogMTZweDsgaGVpZ2h0OiAxNnB4OyBkaXNwbGF5OiBibG9jazsgZmlsbDogaW5oZXJpdDsgZmxleC1zaHJpbms6IDA7IHBhZGRpbmctcmlnaHQ6IDRweDsiPjxwYXRoIGQ9Ik0yLjQwNCAxNS4zMjJoNS43MDFjMS4yNiAwIDEuODg3LS42NjIgMS44ODctMS45MjdWMTIuMzhoMS4xNTRjMS4yNTQgMCAxLjkxLS42NjIgMS45MS0xLjkyOFY1LjU1NWMwLS43NzQtLjE1OC0xLjI2Ni0uNjI2LTEuNzRMOS41MTIuODM3QzkuMDY2LjM4NyA4LjU0NS4yMSA3Ljg2NS4yMUg1LjQ2M2MtMS4yNTQgMC0xLjkxLjY2Mi0xLjkxIDEuOTI4djEuMDg0SDIuNDA0Yy0xLjI1NCAwLTEuOTEuNjY4LTEuOTEgMS45MzN2OC4yMzljMCAxLjI2NS42NTYgMS45MjcgMS45MSAxLjkyN3ptNy41ODgtNi42MmMwLS43OTItLjEtMS4xNjEtLjU5Mi0xLjY2NUw2LjIyNSAzLjgxNGMtLjQ1Mi0uNDYyLS44NDQtLjU4LTEuNS0uNTkxVjIuMjE1YzAtLjUzMy4yOC0uODMyLjg0My0uODMyaDIuMzh2Mi44ODNjMCAuNzI2LjM4NiAxLjExMyAxLjEwNyAxLjExM2gyLjgzdjQuOTk4YzAgLjUzOS0uMjc2LjgzMi0uODQ0LjgzMkg5Ljk5MlY4LjcwMXptLS43OS00LjI5Yy0uMjA2IDAtLjI4OC0uMDg4LS4yODgtLjI4N1YxLjU5NGwyLjc3MSAyLjgxOEg5LjIwMXpNMi41MDMgMTQuMTVjLS41NjMgMC0uODQ0LS4yOTMtLjg0NC0uODMyVjUuMjMyYzAtLjUzOS4yODEtLjgzNy44NS0uODM3aDEuOTF2My4xODdjMCAuODUuNDE2IDEuMjYgMS4yNiAxLjI2aDMuMTR2NC40NzZjMCAuNTQtLjI4LjgzMi0uODQzLjgzMkgyLjUwNHpNNS43OSA3LjgxNmMtLjI0IDAtLjM0Ni0uMTA1LS4zNDYtLjM0NVY0LjU0N2wzLjIyMyAzLjI3SDUuNzkxeiIgLz48L3N2Zz4=)

Copy

ccc create spark wordcount.py -s

​

Running the config and spark job file from pre-existing job - note all
jobs configs are created in ~/spark_jobs folder

Bash

[data:image/svg+xml;base64,PHN2ZyByb2xlPSJncmFwaGljcy1zeW1ib2wiIHZpZXdib3g9IjAgMCAxNCAxNiIgY2xhc3M9ImNvcHkiIHN0eWxlPSJ3aWR0aDogMTZweDsgaGVpZ2h0OiAxNnB4OyBkaXNwbGF5OiBibG9jazsgZmlsbDogaW5oZXJpdDsgZmxleC1zaHJpbms6IDA7IHBhZGRpbmctcmlnaHQ6IDRweDsiPjxwYXRoIGQ9Ik0yLjQwNCAxNS4zMjJoNS43MDFjMS4yNiAwIDEuODg3LS42NjIgMS44ODctMS45MjdWMTIuMzhoMS4xNTRjMS4yNTQgMCAxLjkxLS42NjIgMS45MS0xLjkyOFY1LjU1NWMwLS43NzQtLjE1OC0xLjI2Ni0uNjI2LTEuNzRMOS41MTIuODM3QzkuMDY2LjM4NyA4LjU0NS4yMSA3Ljg2NS4yMUg1LjQ2M2MtMS4yNTQgMC0xLjkxLjY2Mi0xLjkxIDEuOTI4djEuMDg0SDIuNDA0Yy0xLjI1NCAwLTEuOTEuNjY4LTEuOTEgMS45MzN2OC4yMzljMCAxLjI2NS42NTYgMS45MjcgMS45MSAxLjkyN3ptNy41ODgtNi42MmMwLS43OTItLjEtMS4xNjEtLjU5Mi0xLjY2NUw2LjIyNSAzLjgxNGMtLjQ1Mi0uNDYyLS44NDQtLjU4LTEuNS0uNTkxVjIuMjE1YzAtLjUzMy4yOC0uODMyLjg0My0uODMyaDIuMzh2Mi44ODNjMCAuNzI2LjM4NiAxLjExMyAxLjEwNyAxLjExM2gyLjgzdjQuOTk4YzAgLjUzOS0uMjc2LjgzMi0uODQ0LjgzMkg5Ljk5MlY4LjcwMXptLS43OS00LjI5Yy0uMjA2IDAtLjI4OC0uMDg4LS4yODgtLjI4N1YxLjU5NGwyLjc3MSAyLjgxOEg5LjIwMXpNMi41MDMgMTQuMTVjLS41NjMgMC0uODQ0LS4yOTMtLjg0NC0uODMyVjUuMjMyYzAtLjUzOS4yODEtLjgzNy44NS0uODM3aDEuOTF2My4xODdjMCAuODUuNDE2IDEuMjYgMS4yNiAxLjI2aDMuMTR2NC40NzZjMCAuNTQtLjI4LjgzMi0uODQzLjgzMkgyLjUwNHpNNS43OSA3LjgxNmMtLjI0IDAtLjM0Ni0uMTA1LS4zNDYtLjM0NVY0LjU0N2wzLjIyMyAzLjI3SDUuNzkxeiIgLz48L3N2Zz4=](data:image/svg+xml;base64,PHN2ZyByb2xlPSJncmFwaGljcy1zeW1ib2wiIHZpZXdib3g9IjAgMCAxNCAxNiIgY2xhc3M9ImNvcHkiIHN0eWxlPSJ3aWR0aDogMTZweDsgaGVpZ2h0OiAxNnB4OyBkaXNwbGF5OiBibG9jazsgZmlsbDogaW5oZXJpdDsgZmxleC1zaHJpbms6IDA7IHBhZGRpbmctcmlnaHQ6IDRweDsiPjxwYXRoIGQ9Ik0yLjQwNCAxNS4zMjJoNS43MDFjMS4yNiAwIDEuODg3LS42NjIgMS44ODctMS45MjdWMTIuMzhoMS4xNTRjMS4yNTQgMCAxLjkxLS42NjIgMS45MS0xLjkyOFY1LjU1NWMwLS43NzQtLjE1OC0xLjI2Ni0uNjI2LTEuNzRMOS41MTIuODM3QzkuMDY2LjM4NyA4LjU0NS4yMSA3Ljg2NS4yMUg1LjQ2M2MtMS4yNTQgMC0xLjkxLjY2Mi0xLjkxIDEuOTI4djEuMDg0SDIuNDA0Yy0xLjI1NCAwLTEuOTEuNjY4LTEuOTEgMS45MzN2OC4yMzljMCAxLjI2NS42NTYgMS45MjcgMS45MSAxLjkyN3ptNy41ODgtNi42MmMwLS43OTItLjEtMS4xNjEtLjU5Mi0xLjY2NUw2LjIyNSAzLjgxNGMtLjQ1Mi0uNDYyLS44NDQtLjU4LTEuNS0uNTkxVjIuMjE1YzAtLjUzMy4yOC0uODMyLjg0My0uODMyaDIuMzh2Mi44ODNjMCAuNzI2LjM4NiAxLjExMyAxLjEwNyAxLjExM2gyLjgzdjQuOTk4YzAgLjUzOS0uMjc2LjgzMi0uODQ0LjgzMkg5Ljk5MlY4LjcwMXptLS43OS00LjI5Yy0uMjA2IDAtLjI4OC0uMDg4LS4yODgtLjI4N1YxLjU5NGwyLjc3MSAyLjgxOEg5LjIwMXpNMi41MDMgMTQuMTVjLS41NjMgMC0uODQ0LS4yOTMtLjg0NC0uODMyVjUuMjMyYzAtLjUzOS4yODEtLjgzNy44NS0uODM3aDEuOTF2My4xODdjMCAuODUuNDE2IDEuMjYgMS4yNiAxLjI2aDMuMTR2NC40NzZjMCAuNTQtLjI4LjgzMi0uODQzLjgzMkgyLjUwNHpNNS43OSA3LjgxNmMtLjI0IDAtLjM0Ni0uMTA1LS4zNDYtLjM0NVY0LjU0N2wzLjIyMyAzLjI3SDUuNzkxeiIgLz48L3N2Zz4=)

Copy

oc apply -f
~/spark_jobs/wordcount/wordcount_ConfigMap.yaml -f
~/spark_jobs/wordcount/wordcount_spark_app.yaml

​

Stopping a running job - note all jobs configs are created in
~/spark_jobs folder

Bash

[data:image/svg+xml;base64,PHN2ZyByb2xlPSJncmFwaGljcy1zeW1ib2wiIHZpZXdib3g9IjAgMCAxNCAxNiIgY2xhc3M9ImNvcHkiIHN0eWxlPSJ3aWR0aDogMTZweDsgaGVpZ2h0OiAxNnB4OyBkaXNwbGF5OiBibG9jazsgZmlsbDogaW5oZXJpdDsgZmxleC1zaHJpbms6IDA7IHBhZGRpbmctcmlnaHQ6IDRweDsiPjxwYXRoIGQ9Ik0yLjQwNCAxNS4zMjJoNS43MDFjMS4yNiAwIDEuODg3LS42NjIgMS44ODctMS45MjdWMTIuMzhoMS4xNTRjMS4yNTQgMCAxLjkxLS42NjIgMS45MS0xLjkyOFY1LjU1NWMwLS43NzQtLjE1OC0xLjI2Ni0uNjI2LTEuNzRMOS41MTIuODM3QzkuMDY2LjM4NyA4LjU0NS4yMSA3Ljg2NS4yMUg1LjQ2M2MtMS4yNTQgMC0xLjkxLjY2Mi0xLjkxIDEuOTI4djEuMDg0SDIuNDA0Yy0xLjI1NCAwLTEuOTEuNjY4LTEuOTEgMS45MzN2OC4yMzljMCAxLjI2NS42NTYgMS45MjcgMS45MSAxLjkyN3ptNy41ODgtNi42MmMwLS43OTItLjEtMS4xNjEtLjU5Mi0xLjY2NUw2LjIyNSAzLjgxNGMtLjQ1Mi0uNDYyLS44NDQtLjU4LTEuNS0uNTkxVjIuMjE1YzAtLjUzMy4yOC0uODMyLjg0My0uODMyaDIuMzh2Mi44ODNjMCAuNzI2LjM4NiAxLjExMyAxLjEwNyAxLjExM2gyLjgzdjQuOTk4YzAgLjUzOS0uMjc2LjgzMi0uODQ0LjgzMkg5Ljk5MlY4LjcwMXptLS43OS00LjI5Yy0uMjA2IDAtLjI4OC0uMDg4LS4yODgtLjI4N1YxLjU5NGwyLjc3MSAyLjgxOEg5LjIwMXpNMi41MDMgMTQuMTVjLS41NjMgMC0uODQ0LS4yOTMtLjg0NC0uODMyVjUuMjMyYzAtLjUzOS4yODEtLjgzNy44NS0uODM3aDEuOTF2My4xODdjMCAuODUuNDE2IDEuMjYgMS4yNiAxLjI2aDMuMTR2NC40NzZjMCAuNTQtLjI4LjgzMi0uODQzLjgzMkgyLjUwNHpNNS43OSA3LjgxNmMtLjI0IDAtLjM0Ni0uMTA1LS4zNDYtLjM0NVY0LjU0N2wzLjIyMyAzLjI3SDUuNzkxeiIgLz48L3N2Zz4=](data:image/svg+xml;base64,PHN2ZyByb2xlPSJncmFwaGljcy1zeW1ib2wiIHZpZXdib3g9IjAgMCAxNCAxNiIgY2xhc3M9ImNvcHkiIHN0eWxlPSJ3aWR0aDogMTZweDsgaGVpZ2h0OiAxNnB4OyBkaXNwbGF5OiBibG9jazsgZmlsbDogaW5oZXJpdDsgZmxleC1zaHJpbms6IDA7IHBhZGRpbmctcmlnaHQ6IDRweDsiPjxwYXRoIGQ9Ik0yLjQwNCAxNS4zMjJoNS43MDFjMS4yNiAwIDEuODg3LS42NjIgMS44ODctMS45MjdWMTIuMzhoMS4xNTRjMS4yNTQgMCAxLjkxLS42NjIgMS45MS0xLjkyOFY1LjU1NWMwLS43NzQtLjE1OC0xLjI2Ni0uNjI2LTEuNzRMOS41MTIuODM3QzkuMDY2LjM4NyA4LjU0NS4yMSA3Ljg2NS4yMUg1LjQ2M2MtMS4yNTQgMC0xLjkxLjY2Mi0xLjkxIDEuOTI4djEuMDg0SDIuNDA0Yy0xLjI1NCAwLTEuOTEuNjY4LTEuOTEgMS45MzN2OC4yMzljMCAxLjI2NS42NTYgMS45MjcgMS45MSAxLjkyN3ptNy41ODgtNi42MmMwLS43OTItLjEtMS4xNjEtLjU5Mi0xLjY2NUw2LjIyNSAzLjgxNGMtLjQ1Mi0uNDYyLS44NDQtLjU4LTEuNS0uNTkxVjIuMjE1YzAtLjUzMy4yOC0uODMyLjg0My0uODMyaDIuMzh2Mi44ODNjMCAuNzI2LjM4NiAxLjExMyAxLjEwNyAxLjExM2gyLjgzdjQuOTk4YzAgLjUzOS0uMjc2LjgzMi0uODQ0LjgzMkg5Ljk5MlY4LjcwMXptLS43OS00LjI5Yy0uMjA2IDAtLjI4OC0uMDg4LS4yODgtLjI4N1YxLjU5NGwyLjc3MSAyLjgxOEg5LjIwMXpNMi41MDMgMTQuMTVjLS41NjMgMC0uODQ0LS4yOTMtLjg0NC0uODMyVjUuMjMyYzAtLjUzOS4yODEtLjgzNy44NS0uODM3aDEuOTF2My4xODdjMCAuODUuNDE2IDEuMjYgMS4yNiAxLjI2aDMuMTR2NC40NzZjMCAuNTQtLjI4LjgzMi0uODQzLjgzMkgyLjUwNHpNNS43OSA3LjgxNmMtLjI0IDAtLjM0Ni0uMTA1LS4zNDYtLjM0NVY0LjU0N2wzLjIyMyAzLjI3SDUuNzkxeiIgLz48L3N2Zz4=)

Copy

oc delete -f
~/spark_jobs/wordcount/wordcount_spark_app.yaml

​

Checking the status of the jobs

Bash

[data:image/svg+xml;base64,PHN2ZyByb2xlPSJncmFwaGljcy1zeW1ib2wiIHZpZXdib3g9IjAgMCAxNCAxNiIgY2xhc3M9ImNvcHkiIHN0eWxlPSJ3aWR0aDogMTZweDsgaGVpZ2h0OiAxNnB4OyBkaXNwbGF5OiBibG9jazsgZmlsbDogaW5oZXJpdDsgZmxleC1zaHJpbms6IDA7IHBhZGRpbmctcmlnaHQ6IDRweDsiPjxwYXRoIGQ9Ik0yLjQwNCAxNS4zMjJoNS43MDFjMS4yNiAwIDEuODg3LS42NjIgMS44ODctMS45MjdWMTIuMzhoMS4xNTRjMS4yNTQgMCAxLjkxLS42NjIgMS45MS0xLjkyOFY1LjU1NWMwLS43NzQtLjE1OC0xLjI2Ni0uNjI2LTEuNzRMOS41MTIuODM3QzkuMDY2LjM4NyA4LjU0NS4yMSA3Ljg2NS4yMUg1LjQ2M2MtMS4yNTQgMC0xLjkxLjY2Mi0xLjkxIDEuOTI4djEuMDg0SDIuNDA0Yy0xLjI1NCAwLTEuOTEuNjY4LTEuOTEgMS45MzN2OC4yMzljMCAxLjI2NS42NTYgMS45MjcgMS45MSAxLjkyN3ptNy41ODgtNi42MmMwLS43OTItLjEtMS4xNjEtLjU5Mi0xLjY2NUw2LjIyNSAzLjgxNGMtLjQ1Mi0uNDYyLS44NDQtLjU4LTEuNS0uNTkxVjIuMjE1YzAtLjUzMy4yOC0uODMyLjg0My0uODMyaDIuMzh2Mi44ODNjMCAuNzI2LjM4NiAxLjExMyAxLjEwNyAxLjExM2gyLjgzdjQuOTk4YzAgLjUzOS0uMjc2LjgzMi0uODQ0LjgzMkg5Ljk5MlY4LjcwMXptLS43OS00LjI5Yy0uMjA2IDAtLjI4OC0uMDg4LS4yODgtLjI4N1YxLjU5NGwyLjc3MSAyLjgxOEg5LjIwMXpNMi41MDMgMTQuMTVjLS41NjMgMC0uODQ0LS4yOTMtLjg0NC0uODMyVjUuMjMyYzAtLjUzOS4yODEtLjgzNy44NS0uODM3aDEuOTF2My4xODdjMCAuODUuNDE2IDEuMjYgMS4yNiAxLjI2aDMuMTR2NC40NzZjMCAuNTQtLjI4LjgzMi0uODQzLjgzMkgyLjUwNHpNNS43OSA3LjgxNmMtLjI0IDAtLjM0Ni0uMTA1LS4zNDYtLjM0NVY0LjU0N2wzLjIyMyAzLjI3SDUuNzkxeiIgLz48L3N2Zz4=](data:image/svg+xml;base64,PHN2ZyByb2xlPSJncmFwaGljcy1zeW1ib2wiIHZpZXdib3g9IjAgMCAxNCAxNiIgY2xhc3M9ImNvcHkiIHN0eWxlPSJ3aWR0aDogMTZweDsgaGVpZ2h0OiAxNnB4OyBkaXNwbGF5OiBibG9jazsgZmlsbDogaW5oZXJpdDsgZmxleC1zaHJpbms6IDA7IHBhZGRpbmctcmlnaHQ6IDRweDsiPjxwYXRoIGQ9Ik0yLjQwNCAxNS4zMjJoNS43MDFjMS4yNiAwIDEuODg3LS42NjIgMS44ODctMS45MjdWMTIuMzhoMS4xNTRjMS4yNTQgMCAxLjkxLS42NjIgMS45MS0xLjkyOFY1LjU1NWMwLS43NzQtLjE1OC0xLjI2Ni0uNjI2LTEuNzRMOS41MTIuODM3QzkuMDY2LjM4NyA4LjU0NS4yMSA3Ljg2NS4yMUg1LjQ2M2MtMS4yNTQgMC0xLjkxLjY2Mi0xLjkxIDEuOTI4djEuMDg0SDIuNDA0Yy0xLjI1NCAwLTEuOTEuNjY4LTEuOTEgMS45MzN2OC4yMzljMCAxLjI2NS42NTYgMS45MjcgMS45MSAxLjkyN3ptNy41ODgtNi42MmMwLS43OTItLjEtMS4xNjEtLjU5Mi0xLjY2NUw2LjIyNSAzLjgxNGMtLjQ1Mi0uNDYyLS44NDQtLjU4LTEuNS0uNTkxVjIuMjE1YzAtLjUzMy4yOC0uODMyLjg0My0uODMyaDIuMzh2Mi44ODNjMCAuNzI2LjM4NiAxLjExMyAxLjEwNyAxLjExM2gyLjgzdjQuOTk4YzAgLjUzOS0uMjc2LjgzMi0uODQ0LjgzMkg5Ljk5MlY4LjcwMXptLS43OS00LjI5Yy0uMjA2IDAtLjI4OC0uMDg4LS4yODgtLjI4N1YxLjU5NGwyLjc3MSAyLjgxOEg5LjIwMXpNMi41MDMgMTQuMTVjLS41NjMgMC0uODQ0LS4yOTMtLjg0NC0uODMyVjUuMjMyYzAtLjUzOS4yODEtLjgzNy44NS0uODM3aDEuOTF2My4xODdjMCAuODUuNDE2IDEuMjYgMS4yNiAxLjI2aDMuMTR2NC40NzZjMCAuNTQtLjI4LjgzMi0uODQzLjgzMkgyLjUwNHpNNS43OSA3LjgxNmMtLjI0IDAtLjM0Ni0uMTA1LS4zNDYtLjM0NVY0LjU0N2wzLjIyMyAzLjI3SDUuNzkxeiIgLz48L3N2Zz4=)

Copy

watch ccc get spark -m -e

​

Checking the spark job history - search your ITS username

History Server

![https://www.notion.so./QMUL%20Spark%20on%20Jhub_K8S%20Cluster_files/spark-logo-77x50px-hd.png](https://www.notion.so./QMUL%20Spark%20on%20Jhub_K8S%20Cluster_files/spark-logo-77x50px-hd.png)

https://spark-history.comp-teach.qmul.ac.uk/

![https://www.notion.so./QMUL%20Spark%20on%20Jhub_K8S%20Cluster_files/spark-logo-77x50px-hd(1).png](https://www.notion.so./QMUL%20Spark%20on%20Jhub_K8S%20Cluster_files/spark-logo-77x50px-hd(1).png)

Reading the log files of your job to identify any issue

Bash

[data:image/svg+xml;base64,PHN2ZyByb2xlPSJncmFwaGljcy1zeW1ib2wiIHZpZXdib3g9IjAgMCAxNCAxNiIgY2xhc3M9ImNvcHkiIHN0eWxlPSJ3aWR0aDogMTZweDsgaGVpZ2h0OiAxNnB4OyBkaXNwbGF5OiBibG9jazsgZmlsbDogaW5oZXJpdDsgZmxleC1zaHJpbms6IDA7IHBhZGRpbmctcmlnaHQ6IDRweDsiPjxwYXRoIGQ9Ik0yLjQwNCAxNS4zMjJoNS43MDFjMS4yNiAwIDEuODg3LS42NjIgMS44ODctMS45MjdWMTIuMzhoMS4xNTRjMS4yNTQgMCAxLjkxLS42NjIgMS45MS0xLjkyOFY1LjU1NWMwLS43NzQtLjE1OC0xLjI2Ni0uNjI2LTEuNzRMOS41MTIuODM3QzkuMDY2LjM4NyA4LjU0NS4yMSA3Ljg2NS4yMUg1LjQ2M2MtMS4yNTQgMC0xLjkxLjY2Mi0xLjkxIDEuOTI4djEuMDg0SDIuNDA0Yy0xLjI1NCAwLTEuOTEuNjY4LTEuOTEgMS45MzN2OC4yMzljMCAxLjI2NS42NTYgMS45MjcgMS45MSAxLjkyN3ptNy41ODgtNi42MmMwLS43OTItLjEtMS4xNjEtLjU5Mi0xLjY2NUw2LjIyNSAzLjgxNGMtLjQ1Mi0uNDYyLS44NDQtLjU4LTEuNS0uNTkxVjIuMjE1YzAtLjUzMy4yOC0uODMyLjg0My0uODMyaDIuMzh2Mi44ODNjMCAuNzI2LjM4NiAxLjExMyAxLjEwNyAxLjExM2gyLjgzdjQuOTk4YzAgLjUzOS0uMjc2LjgzMi0uODQ0LjgzMkg5Ljk5MlY4LjcwMXptLS43OS00LjI5Yy0uMjA2IDAtLjI4OC0uMDg4LS4yODgtLjI4N1YxLjU5NGwyLjc3MSAyLjgxOEg5LjIwMXpNMi41MDMgMTQuMTVjLS41NjMgMC0uODQ0LS4yOTMtLjg0NC0uODMyVjUuMjMyYzAtLjUzOS4yODEtLjgzNy44NS0uODM3aDEuOTF2My4xODdjMCAuODUuNDE2IDEuMjYgMS4yNiAxLjI2aDMuMTR2NC40NzZjMCAuNTQtLjI4LjgzMi0uODQzLjgzMkgyLjUwNHpNNS43OSA3LjgxNmMtLjI0IDAtLjM0Ni0uMTA1LS4zNDYtLjM0NVY0LjU0N2wzLjIyMyAzLjI3SDUuNzkxeiIgLz48L3N2Zz4=](data:image/svg+xml;base64,PHN2ZyByb2xlPSJncmFwaGljcy1zeW1ib2wiIHZpZXdib3g9IjAgMCAxNCAxNiIgY2xhc3M9ImNvcHkiIHN0eWxlPSJ3aWR0aDogMTZweDsgaGVpZ2h0OiAxNnB4OyBkaXNwbGF5OiBibG9jazsgZmlsbDogaW5oZXJpdDsgZmxleC1zaHJpbms6IDA7IHBhZGRpbmctcmlnaHQ6IDRweDsiPjxwYXRoIGQ9Ik0yLjQwNCAxNS4zMjJoNS43MDFjMS4yNiAwIDEuODg3LS42NjIgMS44ODctMS45MjdWMTIuMzhoMS4xNTRjMS4yNTQgMCAxLjkxLS42NjIgMS45MS0xLjkyOFY1LjU1NWMwLS43NzQtLjE1OC0xLjI2Ni0uNjI2LTEuNzRMOS41MTIuODM3QzkuMDY2LjM4NyA4LjU0NS4yMSA3Ljg2NS4yMUg1LjQ2M2MtMS4yNTQgMC0xLjkxLjY2Mi0xLjkxIDEuOTI4djEuMDg0SDIuNDA0Yy0xLjI1NCAwLTEuOTEuNjY4LTEuOTEgMS45MzN2OC4yMzljMCAxLjI2NS42NTYgMS45MjcgMS45MSAxLjkyN3ptNy41ODgtNi42MmMwLS43OTItLjEtMS4xNjEtLjU5Mi0xLjY2NUw2LjIyNSAzLjgxNGMtLjQ1Mi0uNDYyLS44NDQtLjU4LTEuNS0uNTkxVjIuMjE1YzAtLjUzMy4yOC0uODMyLjg0My0uODMyaDIuMzh2Mi44ODNjMCAuNzI2LjM4NiAxLjExMyAxLjEwNyAxLjExM2gyLjgzdjQuOTk4YzAgLjUzOS0uMjc2LjgzMi0uODQ0LjgzMkg5Ljk5MlY4LjcwMXptLS43OS00LjI5Yy0uMjA2IDAtLjI4OC0uMDg4LS4yODgtLjI4N1YxLjU5NGwyLjc3MSAyLjgxOEg5LjIwMXpNMi41MDMgMTQuMTVjLS41NjMgMC0uODQ0LS4yOTMtLjg0NC0uODMyVjUuMjMyYzAtLjUzOS4yODEtLjgzNy44NS0uODM3aDEuOTF2My4xODdjMCAuODUuNDE2IDEuMjYgMS4yNiAxLjI2aDMuMTR2NC40NzZjMCAuNTQtLjI4LjgzMi0uODQzLjgzMkgyLjUwNHpNNS43OSA3LjgxNmMtLjI0IDAtLjM0Ni0uMTA1LS4zNDYtLjM0NVY0LjU0N2wzLjIyMyAzLjI3SDUuNzkxeiIgLz48L3N2Zz4=)

Copy

oc logs -f
wordcount-spark-app-driver

​

Copy files/folders from/to your personal bucket to your current local
directory (only use -r for recursive copy, i.e., when copying a folder)

Bash

[data:image/svg+xml;base64,PHN2ZyByb2xlPSJncmFwaGljcy1zeW1ib2wiIHZpZXdib3g9IjAgMCAxNCAxNiIgY2xhc3M9ImNvcHkiIHN0eWxlPSJ3aWR0aDogMTZweDsgaGVpZ2h0OiAxNnB4OyBkaXNwbGF5OiBibG9jazsgZmlsbDogaW5oZXJpdDsgZmxleC1zaHJpbms6IDA7IHBhZGRpbmctcmlnaHQ6IDRweDsiPjxwYXRoIGQ9Ik0yLjQwNCAxNS4zMjJoNS43MDFjMS4yNiAwIDEuODg3LS42NjIgMS44ODctMS45MjdWMTIuMzhoMS4xNTRjMS4yNTQgMCAxLjkxLS42NjIgMS45MS0xLjkyOFY1LjU1NWMwLS43NzQtLjE1OC0xLjI2Ni0uNjI2LTEuNzRMOS41MTIuODM3QzkuMDY2LjM4NyA4LjU0NS4yMSA3Ljg2NS4yMUg1LjQ2M2MtMS4yNTQgMC0xLjkxLjY2Mi0xLjkxIDEuOTI4djEuMDg0SDIuNDA0Yy0xLjI1NCAwLTEuOTEuNjY4LTEuOTEgMS45MzN2OC4yMzljMCAxLjI2NS42NTYgMS45MjcgMS45MSAxLjkyN3ptNy41ODgtNi42MmMwLS43OTItLjEtMS4xNjEtLjU5Mi0xLjY2NUw2LjIyNSAzLjgxNGMtLjQ1Mi0uNDYyLS44NDQtLjU4LTEuNS0uNTkxVjIuMjE1YzAtLjUzMy4yOC0uODMyLjg0My0uODMyaDIuMzh2Mi44ODNjMCAuNzI2LjM4NiAxLjExMyAxLjEwNyAxLjExM2gyLjgzdjQuOTk4YzAgLjUzOS0uMjc2LjgzMi0uODQ0LjgzMkg5Ljk5MlY4LjcwMXptLS43OS00LjI5Yy0uMjA2IDAtLjI4OC0uMDg4LS4yODgtLjI4N1YxLjU5NGwyLjc3MSAyLjgxOEg5LjIwMXpNMi41MDMgMTQuMTVjLS41NjMgMC0uODQ0LS4yOTMtLjg0NC0uODMyVjUuMjMyYzAtLjUzOS4yODEtLjgzNy44NS0uODM3aDEuOTF2My4xODdjMCAuODUuNDE2IDEuMjYgMS4yNiAxLjI2aDMuMTR2NC40NzZjMCAuNTQtLjI4LjgzMi0uODQzLjgzMkgyLjUwNHpNNS43OSA3LjgxNmMtLjI0IDAtLjM0Ni0uMTA1LS4zNDYtLjM0NVY0LjU0N2wzLjIyMyAzLjI3SDUuNzkxeiIgLz48L3N2Zz4=](data:image/svg+xml;base64,PHN2ZyByb2xlPSJncmFwaGljcy1zeW1ib2wiIHZpZXdib3g9IjAgMCAxNCAxNiIgY2xhc3M9ImNvcHkiIHN0eWxlPSJ3aWR0aDogMTZweDsgaGVpZ2h0OiAxNnB4OyBkaXNwbGF5OiBibG9jazsgZmlsbDogaW5oZXJpdDsgZmxleC1zaHJpbms6IDA7IHBhZGRpbmctcmlnaHQ6IDRweDsiPjxwYXRoIGQ9Ik0yLjQwNCAxNS4zMjJoNS43MDFjMS4yNiAwIDEuODg3LS42NjIgMS44ODctMS45MjdWMTIuMzhoMS4xNTRjMS4yNTQgMCAxLjkxLS42NjIgMS45MS0xLjkyOFY1LjU1NWMwLS43NzQtLjE1OC0xLjI2Ni0uNjI2LTEuNzRMOS41MTIuODM3QzkuMDY2LjM4NyA4LjU0NS4yMSA3Ljg2NS4yMUg1LjQ2M2MtMS4yNTQgMC0xLjkxLjY2Mi0xLjkxIDEuOTI4djEuMDg0SDIuNDA0Yy0xLjI1NCAwLTEuOTEuNjY4LTEuOTEgMS45MzN2OC4yMzljMCAxLjI2NS42NTYgMS45MjcgMS45MSAxLjkyN3ptNy41ODgtNi42MmMwLS43OTItLjEtMS4xNjEtLjU5Mi0xLjY2NUw2LjIyNSAzLjgxNGMtLjQ1Mi0uNDYyLS44NDQtLjU4LTEuNS0uNTkxVjIuMjE1YzAtLjUzMy4yOC0uODMyLjg0My0uODMyaDIuMzh2Mi44ODNjMCAuNzI2LjM4NiAxLjExMyAxLjEwNyAxLjExM2gyLjgzdjQuOTk4YzAgLjUzOS0uMjc2LjgzMi0uODQ0LjgzMkg5Ljk5MlY4LjcwMXptLS43OS00LjI5Yy0uMjA2IDAtLjI4OC0uMDg4LS4yODgtLjI4N1YxLjU5NGwyLjc3MSAyLjgxOEg5LjIwMXpNMi41MDMgMTQuMTVjLS41NjMgMC0uODQ0LS4yOTMtLjg0NC0uODMyVjUuMjMyYzAtLjUzOS4yODEtLjgzNy44NS0uODM3aDEuOTF2My4xODdjMCAuODUuNDE2IDEuMjYgMS4yNiAxLjI2aDMuMTR2NC40NzZjMCAuNTQtLjI4LjgzMi0uODQzLjgzMkgyLjUwNHpNNS43OSA3LjgxNmMtLjI0IDAtLjM0Ni0uMTA1LS4zNDYtLjM0NVY0LjU0N2wzLjIyMyAzLjI3SDUuNzkxeiIgLz48L3N2Zz4=)

Copy

ccc method bucket cp sherlock.txt bkt:sherlock.txt ccc method bucket
cp -r bkt:sorted_counts_31-01-2023_20:11:34
output

​

Listing the contents of your personal bucket or the shared data bucket

Bash

[data:image/svg+xml;base64,PHN2ZyByb2xlPSJncmFwaGljcy1zeW1ib2wiIHZpZXdib3g9IjAgMCAxNCAxNiIgY2xhc3M9ImNvcHkiIHN0eWxlPSJ3aWR0aDogMTZweDsgaGVpZ2h0OiAxNnB4OyBkaXNwbGF5OiBibG9jazsgZmlsbDogaW5oZXJpdDsgZmxleC1zaHJpbms6IDA7IHBhZGRpbmctcmlnaHQ6IDRweDsiPjxwYXRoIGQ9Ik0yLjQwNCAxNS4zMjJoNS43MDFjMS4yNiAwIDEuODg3LS42NjIgMS44ODctMS45MjdWMTIuMzhoMS4xNTRjMS4yNTQgMCAxLjkxLS42NjIgMS45MS0xLjkyOFY1LjU1NWMwLS43NzQtLjE1OC0xLjI2Ni0uNjI2LTEuNzRMOS41MTIuODM3QzkuMDY2LjM4NyA4LjU0NS4yMSA3Ljg2NS4yMUg1LjQ2M2MtMS4yNTQgMC0xLjkxLjY2Mi0xLjkxIDEuOTI4djEuMDg0SDIuNDA0Yy0xLjI1NCAwLTEuOTEuNjY4LTEuOTEgMS45MzN2OC4yMzljMCAxLjI2NS42NTYgMS45MjcgMS45MSAxLjkyN3ptNy41ODgtNi42MmMwLS43OTItLjEtMS4xNjEtLjU5Mi0xLjY2NUw2LjIyNSAzLjgxNGMtLjQ1Mi0uNDYyLS44NDQtLjU4LTEuNS0uNTkxVjIuMjE1YzAtLjUzMy4yOC0uODMyLjg0My0uODMyaDIuMzh2Mi44ODNjMCAuNzI2LjM4NiAxLjExMyAxLjEwNyAxLjExM2gyLjgzdjQuOTk4YzAgLjUzOS0uMjc2LjgzMi0uODQ0LjgzMkg5Ljk5MlY4LjcwMXptLS43OS00LjI5Yy0uMjA2IDAtLjI4OC0uMDg4LS4yODgtLjI4N1YxLjU5NGwyLjc3MSAyLjgxOEg5LjIwMXpNMi41MDMgMTQuMTVjLS41NjMgMC0uODQ0LS4yOTMtLjg0NC0uODMyVjUuMjMyYzAtLjUzOS4yODEtLjgzNy44NS0uODM3aDEuOTF2My4xODdjMCAuODUuNDE2IDEuMjYgMS4yNiAxLjI2aDMuMTR2NC40NzZjMCAuNTQtLjI4LjgzMi0uODQzLjgzMkgyLjUwNHpNNS43OSA3LjgxNmMtLjI0IDAtLjM0Ni0uMTA1LS4zNDYtLjM0NVY0LjU0N2wzLjIyMyAzLjI3SDUuNzkxeiIgLz48L3N2Zz4=](data:image/svg+xml;base64,PHN2ZyByb2xlPSJncmFwaGljcy1zeW1ib2wiIHZpZXdib3g9IjAgMCAxNCAxNiIgY2xhc3M9ImNvcHkiIHN0eWxlPSJ3aWR0aDogMTZweDsgaGVpZ2h0OiAxNnB4OyBkaXNwbGF5OiBibG9jazsgZmlsbDogaW5oZXJpdDsgZmxleC1zaHJpbms6IDA7IHBhZGRpbmctcmlnaHQ6IDRweDsiPjxwYXRoIGQ9Ik0yLjQwNCAxNS4zMjJoNS43MDFjMS4yNiAwIDEuODg3LS42NjIgMS44ODctMS45MjdWMTIuMzhoMS4xNTRjMS4yNTQgMCAxLjkxLS42NjIgMS45MS0xLjkyOFY1LjU1NWMwLS43NzQtLjE1OC0xLjI2Ni0uNjI2LTEuNzRMOS41MTIuODM3QzkuMDY2LjM4NyA4LjU0NS4yMSA3Ljg2NS4yMUg1LjQ2M2MtMS4yNTQgMC0xLjkxLjY2Mi0xLjkxIDEuOTI4djEuMDg0SDIuNDA0Yy0xLjI1NCAwLTEuOTEuNjY4LTEuOTEgMS45MzN2OC4yMzljMCAxLjI2NS42NTYgMS45MjcgMS45MSAxLjkyN3ptNy41ODgtNi42MmMwLS43OTItLjEtMS4xNjEtLjU5Mi0xLjY2NUw2LjIyNSAzLjgxNGMtLjQ1Mi0uNDYyLS44NDQtLjU4LTEuNS0uNTkxVjIuMjE1YzAtLjUzMy4yOC0uODMyLjg0My0uODMyaDIuMzh2Mi44ODNjMCAuNzI2LjM4NiAxLjExMyAxLjEwNyAxLjExM2gyLjgzdjQuOTk4YzAgLjUzOS0uMjc2LjgzMi0uODQ0LjgzMkg5Ljk5MlY4LjcwMXptLS43OS00LjI5Yy0uMjA2IDAtLjI4OC0uMDg4LS4yODgtLjI4N1YxLjU5NGwyLjc3MSAyLjgxOEg5LjIwMXpNMi41MDMgMTQuMTVjLS41NjMgMC0uODQ0LS4yOTMtLjg0NC0uODMyVjUuMjMyYzAtLjUzOS4yODEtLjgzNy44NS0uODM3aDEuOTF2My4xODdjMCAuODUuNDE2IDEuMjYgMS4yNiAxLjI2aDMuMTR2NC40NzZjMCAuNTQtLjI4LjgzMi0uODQzLjgzMkgyLjUwNHpNNS43OSA3LjgxNmMtLjI0IDAtLjM0Ni0uMTA1LS4zNDYtLjM0NVY0LjU0N2wzLjIyMyAzLjI3SDUuNzkxeiIgLz48L3N2Zz4=)

Copy

ccc method bucket ls ccc method bucket ls //data-repository-bkt ccc method bucket
ls //data-repository-bkt/ECS765

​

Deleting the contents/folders of your personal bucket

Bash

[data:image/svg+xml;base64,PHN2ZyByb2xlPSJncmFwaGljcy1zeW1ib2wiIHZpZXdib3g9IjAgMCAxNCAxNiIgY2xhc3M9ImNvcHkiIHN0eWxlPSJ3aWR0aDogMTZweDsgaGVpZ2h0OiAxNnB4OyBkaXNwbGF5OiBibG9jazsgZmlsbDogaW5oZXJpdDsgZmxleC1zaHJpbms6IDA7IHBhZGRpbmctcmlnaHQ6IDRweDsiPjxwYXRoIGQ9Ik0yLjQwNCAxNS4zMjJoNS43MDFjMS4yNiAwIDEuODg3LS42NjIgMS44ODctMS45MjdWMTIuMzhoMS4xNTRjMS4yNTQgMCAxLjkxLS42NjIgMS45MS0xLjkyOFY1LjU1NWMwLS43NzQtLjE1OC0xLjI2Ni0uNjI2LTEuNzRMOS41MTIuODM3QzkuMDY2LjM4NyA4LjU0NS4yMSA3Ljg2NS4yMUg1LjQ2M2MtMS4yNTQgMC0xLjkxLjY2Mi0xLjkxIDEuOTI4djEuMDg0SDIuNDA0Yy0xLjI1NCAwLTEuOTEuNjY4LTEuOTEgMS45MzN2OC4yMzljMCAxLjI2NS42NTYgMS45MjcgMS45MSAxLjkyN3ptNy41ODgtNi42MmMwLS43OTItLjEtMS4xNjEtLjU5Mi0xLjY2NUw2LjIyNSAzLjgxNGMtLjQ1Mi0uNDYyLS44NDQtLjU4LTEuNS0uNTkxVjIuMjE1YzAtLjUzMy4yOC0uODMyLjg0My0uODMyaDIuMzh2Mi44ODNjMCAuNzI2LjM4NiAxLjExMyAxLjEwNyAxLjExM2gyLjgzdjQuOTk4YzAgLjUzOS0uMjc2LjgzMi0uODQ0LjgzMkg5Ljk5MlY4LjcwMXptLS43OS00LjI5Yy0uMjA2IDAtLjI4OC0uMDg4LS4yODgtLjI4N1YxLjU5NGwyLjc3MSAyLjgxOEg5LjIwMXpNMi41MDMgMTQuMTVjLS41NjMgMC0uODQ0LS4yOTMtLjg0NC0uODMyVjUuMjMyYzAtLjUzOS4yODEtLjgzNy44NS0uODM3aDEuOTF2My4xODdjMCAuODUuNDE2IDEuMjYgMS4yNiAxLjI2aDMuMTR2NC40NzZjMCAuNTQtLjI4LjgzMi0uODQzLjgzMkgyLjUwNHpNNS43OSA3LjgxNmMtLjI0IDAtLjM0Ni0uMTA1LS4zNDYtLjM0NVY0LjU0N2wzLjIyMyAzLjI3SDUuNzkxeiIgLz48L3N2Zz4=](data:image/svg+xml;base64,PHN2ZyByb2xlPSJncmFwaGljcy1zeW1ib2wiIHZpZXdib3g9IjAgMCAxNCAxNiIgY2xhc3M9ImNvcHkiIHN0eWxlPSJ3aWR0aDogMTZweDsgaGVpZ2h0OiAxNnB4OyBkaXNwbGF5OiBibG9jazsgZmlsbDogaW5oZXJpdDsgZmxleC1zaHJpbms6IDA7IHBhZGRpbmctcmlnaHQ6IDRweDsiPjxwYXRoIGQ9Ik0yLjQwNCAxNS4zMjJoNS43MDFjMS4yNiAwIDEuODg3LS42NjIgMS44ODctMS45MjdWMTIuMzhoMS4xNTRjMS4yNTQgMCAxLjkxLS42NjIgMS45MS0xLjkyOFY1LjU1NWMwLS43NzQtLjE1OC0xLjI2Ni0uNjI2LTEuNzRMOS41MTIuODM3QzkuMDY2LjM4NyA4LjU0NS4yMSA3Ljg2NS4yMUg1LjQ2M2MtMS4yNTQgMC0xLjkxLjY2Mi0xLjkxIDEuOTI4djEuMDg0SDIuNDA0Yy0xLjI1NCAwLTEuOTEuNjY4LTEuOTEgMS45MzN2OC4yMzljMCAxLjI2NS42NTYgMS45MjcgMS45MSAxLjkyN3ptNy41ODgtNi42MmMwLS43OTItLjEtMS4xNjEtLjU5Mi0xLjY2NUw2LjIyNSAzLjgxNGMtLjQ1Mi0uNDYyLS44NDQtLjU4LTEuNS0uNTkxVjIuMjE1YzAtLjUzMy4yOC0uODMyLjg0My0uODMyaDIuMzh2Mi44ODNjMCAuNzI2LjM4NiAxLjExMyAxLjEwNyAxLjExM2gyLjgzdjQuOTk4YzAgLjUzOS0uMjc2LjgzMi0uODQ0LjgzMkg5Ljk5MlY4LjcwMXptLS43OS00LjI5Yy0uMjA2IDAtLjI4OC0uMDg4LS4yODgtLjI4N1YxLjU5NGwyLjc3MSAyLjgxOEg5LjIwMXpNMi41MDMgMTQuMTVjLS41NjMgMC0uODQ0LS4yOTMtLjg0NC0uODMyVjUuMjMyYzAtLjUzOS4yODEtLjgzNy44NS0uODM3aDEuOTF2My4xODdjMCAuODUuNDE2IDEuMjYgMS4yNiAxLjI2aDMuMTR2NC40NzZjMCAuNTQtLjI4LjgzMi0uODQzLjgzMkgyLjUwNHpNNS43OSA3LjgxNmMtLjI0IDAtLjM0Ni0uMTA1LS4zNDYtLjM0NVY0LjU0N2wzLjIyMyAzLjI3SDUuNzkxeiIgLz48L3N2Zz4=)

Copy

ccc method bucket rm -r nasdaq_09-03-2023_11:02:51/

​

Merging the output parts

Bash

[data:image/svg+xml;base64,PHN2ZyByb2xlPSJncmFwaGljcy1zeW1ib2wiIHZpZXdib3g9IjAgMCAxNCAxNiIgY2xhc3M9ImNvcHkiIHN0eWxlPSJ3aWR0aDogMTZweDsgaGVpZ2h0OiAxNnB4OyBkaXNwbGF5OiBibG9jazsgZmlsbDogaW5oZXJpdDsgZmxleC1zaHJpbms6IDA7IHBhZGRpbmctcmlnaHQ6IDRweDsiPjxwYXRoIGQ9Ik0yLjQwNCAxNS4zMjJoNS43MDFjMS4yNiAwIDEuODg3LS42NjIgMS44ODctMS45MjdWMTIuMzhoMS4xNTRjMS4yNTQgMCAxLjkxLS42NjIgMS45MS0xLjkyOFY1LjU1NWMwLS43NzQtLjE1OC0xLjI2Ni0uNjI2LTEuNzRMOS41MTIuODM3QzkuMDY2LjM4NyA4LjU0NS4yMSA3Ljg2NS4yMUg1LjQ2M2MtMS4yNTQgMC0xLjkxLjY2Mi0xLjkxIDEuOTI4djEuMDg0SDIuNDA0Yy0xLjI1NCAwLTEuOTEuNjY4LTEuOTEgMS45MzN2OC4yMzljMCAxLjI2NS42NTYgMS45MjcgMS45MSAxLjkyN3ptNy41ODgtNi42MmMwLS43OTItLjEtMS4xNjEtLjU5Mi0xLjY2NUw2LjIyNSAzLjgxNGMtLjQ1Mi0uNDYyLS44NDQtLjU4LTEuNS0uNTkxVjIuMjE1YzAtLjUzMy4yOC0uODMyLjg0My0uODMyaDIuMzh2Mi44ODNjMCAuNzI2LjM4NiAxLjExMyAxLjEwNyAxLjExM2gyLjgzdjQuOTk4YzAgLjUzOS0uMjc2LjgzMi0uODQ0LjgzMkg5Ljk5MlY4LjcwMXptLS43OS00LjI5Yy0uMjA2IDAtLjI4OC0uMDg4LS4yODgtLjI4N1YxLjU5NGwyLjc3MSAyLjgxOEg5LjIwMXpNMi41MDMgMTQuMTVjLS41NjMgMC0uODQ0LS4yOTMtLjg0NC0uODMyVjUuMjMyYzAtLjUzOS4yODEtLjgzNy44NS0uODM3aDEuOTF2My4xODdjMCAuODUuNDE2IDEuMjYgMS4yNiAxLjI2aDMuMTR2NC40NzZjMCAuNTQtLjI4LjgzMi0uODQzLjgzMkgyLjUwNHpNNS43OSA3LjgxNmMtLjI0IDAtLjM0Ni0uMTA1LS4zNDYtLjM0NVY0LjU0N2wzLjIyMyAzLjI3SDUuNzkxeiIgLz48L3N2Zz4=](data:image/svg+xml;base64,PHN2ZyByb2xlPSJncmFwaGljcy1zeW1ib2wiIHZpZXdib3g9IjAgMCAxNCAxNiIgY2xhc3M9ImNvcHkiIHN0eWxlPSJ3aWR0aDogMTZweDsgaGVpZ2h0OiAxNnB4OyBkaXNwbGF5OiBibG9jazsgZmlsbDogaW5oZXJpdDsgZmxleC1zaHJpbms6IDA7IHBhZGRpbmctcmlnaHQ6IDRweDsiPjxwYXRoIGQ9Ik0yLjQwNCAxNS4zMjJoNS43MDFjMS4yNiAwIDEuODg3LS42NjIgMS44ODctMS45MjdWMTIuMzhoMS4xNTRjMS4yNTQgMCAxLjkxLS42NjIgMS45MS0xLjkyOFY1LjU1NWMwLS43NzQtLjE1OC0xLjI2Ni0uNjI2LTEuNzRMOS41MTIuODM3QzkuMDY2LjM4NyA4LjU0NS4yMSA3Ljg2NS4yMUg1LjQ2M2MtMS4yNTQgMC0xLjkxLjY2Mi0xLjkxIDEuOTI4djEuMDg0SDIuNDA0Yy0xLjI1NCAwLTEuOTEuNjY4LTEuOTEgMS45MzN2OC4yMzljMCAxLjI2NS42NTYgMS45MjcgMS45MSAxLjkyN3ptNy41ODgtNi42MmMwLS43OTItLjEtMS4xNjEtLjU5Mi0xLjY2NUw2LjIyNSAzLjgxNGMtLjQ1Mi0uNDYyLS44NDQtLjU4LTEuNS0uNTkxVjIuMjE1YzAtLjUzMy4yOC0uODMyLjg0My0uODMyaDIuMzh2Mi44ODNjMCAuNzI2LjM4NiAxLjExMyAxLjEwNyAxLjExM2gyLjgzdjQuOTk4YzAgLjUzOS0uMjc2LjgzMi0uODQ0LjgzMkg5Ljk5MlY4LjcwMXptLS43OS00LjI5Yy0uMjA2IDAtLjI4OC0uMDg4LS4yODgtLjI4N1YxLjU5NGwyLjc3MSAyLjgxOEg5LjIwMXpNMi41MDMgMTQuMTVjLS41NjMgMC0uODQ0LS4yOTMtLjg0NC0uODMyVjUuMjMyYzAtLjUzOS4yODEtLjgzNy44NS0uODM3aDEuOTF2My4xODdjMCAuODUuNDE2IDEuMjYgMS4yNiAxLjI2aDMuMTR2NC40NzZjMCAuNTQtLjI4LjgzMi0uODQzLjgzMkgyLjUwNHpNNS43OSA3LjgxNmMtLjI0IDAtLjM0Ni0uMTA1LS4zNDYtLjM0NVY0LjU0N2wzLjIyMyAzLjI3SDUuNzkxeiIgLz48L3N2Zz4=)

Copy

cat part* >>
output.txt

​

Adding logging to pyspark

JavaScript

[data:image/svg+xml;base64,PHN2ZyByb2xlPSJncmFwaGljcy1zeW1ib2wiIHZpZXdib3g9IjAgMCAxNCAxNiIgY2xhc3M9ImNvcHkiIHN0eWxlPSJ3aWR0aDogMTZweDsgaGVpZ2h0OiAxNnB4OyBkaXNwbGF5OiBibG9jazsgZmlsbDogaW5oZXJpdDsgZmxleC1zaHJpbms6IDA7IHBhZGRpbmctcmlnaHQ6IDRweDsiPjxwYXRoIGQ9Ik0yLjQwNCAxNS4zMjJoNS43MDFjMS4yNiAwIDEuODg3LS42NjIgMS44ODctMS45MjdWMTIuMzhoMS4xNTRjMS4yNTQgMCAxLjkxLS42NjIgMS45MS0xLjkyOFY1LjU1NWMwLS43NzQtLjE1OC0xLjI2Ni0uNjI2LTEuNzRMOS41MTIuODM3QzkuMDY2LjM4NyA4LjU0NS4yMSA3Ljg2NS4yMUg1LjQ2M2MtMS4yNTQgMC0xLjkxLjY2Mi0xLjkxIDEuOTI4djEuMDg0SDIuNDA0Yy0xLjI1NCAwLTEuOTEuNjY4LTEuOTEgMS45MzN2OC4yMzljMCAxLjI2NS42NTYgMS45MjcgMS45MSAxLjkyN3ptNy41ODgtNi42MmMwLS43OTItLjEtMS4xNjEtLjU5Mi0xLjY2NUw2LjIyNSAzLjgxNGMtLjQ1Mi0uNDYyLS44NDQtLjU4LTEuNS0uNTkxVjIuMjE1YzAtLjUzMy4yOC0uODMyLjg0My0uODMyaDIuMzh2Mi44ODNjMCAuNzI2LjM4NiAxLjExMyAxLjEwNyAxLjExM2gyLjgzdjQuOTk4YzAgLjUzOS0uMjc2LjgzMi0uODQ0LjgzMkg5Ljk5MlY4LjcwMXptLS43OS00LjI5Yy0uMjA2IDAtLjI4OC0uMDg4LS4yODgtLjI4N1YxLjU5NGwyLjc3MSAyLjgxOEg5LjIwMXpNMi41MDMgMTQuMTVjLS41NjMgMC0uODQ0LS4yOTMtLjg0NC0uODMyVjUuMjMyYzAtLjUzOS4yODEtLjgzNy44NS0uODM3aDEuOTF2My4xODdjMCAuODUuNDE2IDEuMjYgMS4yNiAxLjI2aDMuMTR2NC40NzZjMCAuNTQtLjI4LjgzMi0uODQzLjgzMkgyLjUwNHpNNS43OSA3LjgxNmMtLjI0IDAtLjM0Ni0uMTA1LS4zNDYtLjM0NVY0LjU0N2wzLjIyMyAzLjI3SDUuNzkxeiIgLz48L3N2Zz4=](data:image/svg+xml;base64,PHN2ZyByb2xlPSJncmFwaGljcy1zeW1ib2wiIHZpZXdib3g9IjAgMCAxNCAxNiIgY2xhc3M9ImNvcHkiIHN0eWxlPSJ3aWR0aDogMTZweDsgaGVpZ2h0OiAxNnB4OyBkaXNwbGF5OiBibG9jazsgZmlsbDogaW5oZXJpdDsgZmxleC1zaHJpbms6IDA7IHBhZGRpbmctcmlnaHQ6IDRweDsiPjxwYXRoIGQ9Ik0yLjQwNCAxNS4zMjJoNS43MDFjMS4yNiAwIDEuODg3LS42NjIgMS44ODctMS45MjdWMTIuMzhoMS4xNTRjMS4yNTQgMCAxLjkxLS42NjIgMS45MS0xLjkyOFY1LjU1NWMwLS43NzQtLjE1OC0xLjI2Ni0uNjI2LTEuNzRMOS41MTIuODM3QzkuMDY2LjM4NyA4LjU0NS4yMSA3Ljg2NS4yMUg1LjQ2M2MtMS4yNTQgMC0xLjkxLjY2Mi0xLjkxIDEuOTI4djEuMDg0SDIuNDA0Yy0xLjI1NCAwLTEuOTEuNjY4LTEuOTEgMS45MzN2OC4yMzljMCAxLjI2NS42NTYgMS45MjcgMS45MSAxLjkyN3ptNy41ODgtNi42MmMwLS43OTItLjEtMS4xNjEtLjU5Mi0xLjY2NUw2LjIyNSAzLjgxNGMtLjQ1Mi0uNDYyLS44NDQtLjU4LTEuNS0uNTkxVjIuMjE1YzAtLjUzMy4yOC0uODMyLjg0My0uODMyaDIuMzh2Mi44ODNjMCAuNzI2LjM4NiAxLjExMyAxLjEwNyAxLjExM2gyLjgzdjQuOTk4YzAgLjUzOS0uMjc2LjgzMi0uODQ0LjgzMkg5Ljk5MlY4LjcwMXptLS43OS00LjI5Yy0uMjA2IDAtLjI4OC0uMDg4LS4yODgtLjI4N1YxLjU5NGwyLjc3MSAyLjgxOEg5LjIwMXpNMi41MDMgMTQuMTVjLS41NjMgMC0uODQ0LS4yOTMtLjg0NC0uODMyVjUuMjMyYzAtLjUzOS4yODEtLjgzNy44NS0uODM3aDEuOTF2My4xODdjMCAuODUuNDE2IDEuMjYgMS4yNiAxLjI2aDMuMTR2NC40NzZjMCAuNTQtLjI4LjgzMi0uODQzLjgzMkgyLjUwNHpNNS43OSA3LjgxNmMtLjI0IDAtLjM0Ni0uMTA1LS4zNDYtLjM0NVY0LjU0N2wzLjIyMyAzLjI3SDUuNzkxeiIgLz48L3N2Zz4=)

Copy

https://stackoverflow.com/questions/25407550/how-do-i-log-from-my-python-spark-script

​

Processing CSV with fields consisting of strings containing
comma-separated values

Python

[data:image/svg+xml;base64,PHN2ZyByb2xlPSJncmFwaGljcy1zeW1ib2wiIHZpZXdib3g9IjAgMCAxNCAxNiIgY2xhc3M9ImNvcHkiIHN0eWxlPSJ3aWR0aDogMTZweDsgaGVpZ2h0OiAxNnB4OyBkaXNwbGF5OiBibG9jazsgZmlsbDogaW5oZXJpdDsgZmxleC1zaHJpbms6IDA7IHBhZGRpbmctcmlnaHQ6IDRweDsiPjxwYXRoIGQ9Ik0yLjQwNCAxNS4zMjJoNS43MDFjMS4yNiAwIDEuODg3LS42NjIgMS44ODctMS45MjdWMTIuMzhoMS4xNTRjMS4yNTQgMCAxLjkxLS42NjIgMS45MS0xLjkyOFY1LjU1NWMwLS43NzQtLjE1OC0xLjI2Ni0uNjI2LTEuNzRMOS41MTIuODM3QzkuMDY2LjM4NyA4LjU0NS4yMSA3Ljg2NS4yMUg1LjQ2M2MtMS4yNTQgMC0xLjkxLjY2Mi0xLjkxIDEuOTI4djEuMDg0SDIuNDA0Yy0xLjI1NCAwLTEuOTEuNjY4LTEuOTEgMS45MzN2OC4yMzljMCAxLjI2NS42NTYgMS45MjcgMS45MSAxLjkyN3ptNy41ODgtNi42MmMwLS43OTItLjEtMS4xNjEtLjU5Mi0xLjY2NUw2LjIyNSAzLjgxNGMtLjQ1Mi0uNDYyLS44NDQtLjU4LTEuNS0uNTkxVjIuMjE1YzAtLjUzMy4yOC0uODMyLjg0My0uODMyaDIuMzh2Mi44ODNjMCAuNzI2LjM4NiAxLjExMyAxLjEwNyAxLjExM2gyLjgzdjQuOTk4YzAgLjUzOS0uMjc2LjgzMi0uODQ0LjgzMkg5Ljk5MlY4LjcwMXptLS43OS00LjI5Yy0uMjA2IDAtLjI4OC0uMDg4LS4yODgtLjI4N1YxLjU5NGwyLjc3MSAyLjgxOEg5LjIwMXpNMi41MDMgMTQuMTVjLS41NjMgMC0uODQ0LS4yOTMtLjg0NC0uODMyVjUuMjMyYzAtLjUzOS4yODEtLjgzNy44NS0uODM3aDEuOTF2My4xODdjMCAuODUuNDE2IDEuMjYgMS4yNiAxLjI2aDMuMTR2NC40NzZjMCAuNTQtLjI4LjgzMi0uODQzLjgzMkgyLjUwNHpNNS43OSA3LjgxNmMtLjI0IDAtLjM0Ni0uMTA1LS4zNDYtLjM0NVY0LjU0N2wzLjIyMyAzLjI3SDUuNzkxeiIgLz48L3N2Zz4=](data:image/svg+xml;base64,PHN2ZyByb2xlPSJncmFwaGljcy1zeW1ib2wiIHZpZXdib3g9IjAgMCAxNCAxNiIgY2xhc3M9ImNvcHkiIHN0eWxlPSJ3aWR0aDogMTZweDsgaGVpZ2h0OiAxNnB4OyBkaXNwbGF5OiBibG9jazsgZmlsbDogaW5oZXJpdDsgZmxleC1zaHJpbms6IDA7IHBhZGRpbmctcmlnaHQ6IDRweDsiPjxwYXRoIGQ9Ik0yLjQwNCAxNS4zMjJoNS43MDFjMS4yNiAwIDEuODg3LS42NjIgMS44ODctMS45MjdWMTIuMzhoMS4xNTRjMS4yNTQgMCAxLjkxLS42NjIgMS45MS0xLjkyOFY1LjU1NWMwLS43NzQtLjE1OC0xLjI2Ni0uNjI2LTEuNzRMOS41MTIuODM3QzkuMDY2LjM4NyA4LjU0NS4yMSA3Ljg2NS4yMUg1LjQ2M2MtMS4yNTQgMC0xLjkxLjY2Mi0xLjkxIDEuOTI4djEuMDg0SDIuNDA0Yy0xLjI1NCAwLTEuOTEuNjY4LTEuOTEgMS45MzN2OC4yMzljMCAxLjI2NS42NTYgMS45MjcgMS45MSAxLjkyN3ptNy41ODgtNi42MmMwLS43OTItLjEtMS4xNjEtLjU5Mi0xLjY2NUw2LjIyNSAzLjgxNGMtLjQ1Mi0uNDYyLS44NDQtLjU4LTEuNS0uNTkxVjIuMjE1YzAtLjUzMy4yOC0uODMyLjg0My0uODMyaDIuMzh2Mi44ODNjMCAuNzI2LjM4NiAxLjExMyAxLjEwNyAxLjExM2gyLjgzdjQuOTk4YzAgLjUzOS0uMjc2LjgzMi0uODQ0LjgzMkg5Ljk5MlY4LjcwMXptLS43OS00LjI5Yy0uMjA2IDAtLjI4OC0uMDg4LS4yODgtLjI4N1YxLjU5NGwyLjc3MSAyLjgxOEg5LjIwMXpNMi41MDMgMTQuMTVjLS41NjMgMC0uODQ0LS4yOTMtLjg0NC0uODMyVjUuMjMyYzAtLjUzOS4yODEtLjgzNy44NS0uODM3aDEuOTF2My4xODdjMCAuODUuNDE2IDEuMjYgMS4yNiAxLjI2aDMuMTR2NC40NzZjMCAuNTQtLjI4LjgzMi0uODQzLjgzMkgyLjUwNHpNNS43OSA3LjgxNmMtLjI0IDAtLjM0Ni0uMTA1LS4zNDYtLjM0NVY0LjU0N2wzLjIyMyAzLjI3SDUuNzkxeiIgLz48L3N2Zz4=)

Copy

import sys, string
import os
import socket
import time
import operator
import boto3
import json
from pyspark.sql import SparkSession import re
# lexical token
symbols DQUOTED, SQUOTED,
UNQUOTED,
COMMA, NEWLINE
= range(5) _pattern_tuples
= ( (r'"[^"]*"', DQUOTED), (r"'[^']*'", SQUOTED), (r",", COMMA), (r"$", NEWLINE), # matches end of string OR \n
just before end of string (r"[^,\n]+", UNQUOTED), # order in the above list is
important ) _matcher = re.compile( '(' + ')|('.join([i[0] for i in
_pattern_tuples]) + ')', ).match _toktype = [None] + [i[1] for i in
_pattern_tuples] # need dummy at start because
re.MatchObject.lastindex counts from 1  def csv_split(text): """Split
a csv string into a list of fields. Fields may be quoted with " or ' or
be unquoted. An unquoted string can contain both a " and a ', provided
neither is at the start of the string. A trailing \n will be ignored if
present. """ fields = [] pos
= 0 want_field
= True while 1: m = _matcher(text, pos) if not m: raise
ValueError("Problem at offset %d in %r" % (pos,
text)) ttype
= _toktype[m.lastindex] if want_field: if ttype in (DQUOTED,
SQUOTED):
fields.append(m.group(0)[1:-1]) want_field
= False
elif ttype ==
UNQUOTED:
fields.append(m.group(0)) want_field
= False
elif ttype ==
COMMA:
fields.append("") else: assert ttype
== NEWLINE fields.append("") break else: if ttype ==
COMMA: want_field
= True elif ttype ==
NEWLINE: break else: print("*** Error dump
***",
ttype, repr(m.group(0)),
fields) raise ValueError("Missing comma at offset %d in %r" % (pos,
text)) pos
= m.end(0) return fields
if __name__ == "__main__": spark = SparkSession\
.builder\
.appName("CSVReader")\ .getOrCreate() def good_line(line): try: fields
= csv_split(line) #line.split(',')
if len(fields)!= 6: return
False
if str(fields[5]) == "": return False
return
True except: return False
# shared
read-only object bucket containing datasets s3_data_repository_bucket = os.environ['DATA_REPOSITORY_BUCKET'] s3_endpoint_url = os.environ['S3_ENDPOINT_URL']+':'+os.environ['BUCKET_PORT']
s3_access_key_id = os.environ['AWS_ACCESS_KEY_ID'] s3_secret_access_key = os.environ['AWS_SECRET_ACCESS_KEY'] s3_bucket = os.environ['BUCKET_NAME'] hadoopConf
= spark.sparkContext._jsc.hadoopConfiguration() hadoopConf.set("fs.s3a.endpoint", s3_endpoint_url) hadoopConf.set("fs.s3a.access.key", s3_access_key_id) hadoopConf.set("fs.s3a.secret.key", s3_secret_access_key) hadoopConf.set("fs.s3a.path.style.access", "true")
hadoopConf.set("fs.s3a.connection.ssl.enabled", "false") lines
= spark.sparkContext.textFile("s3a://"
+ s3_data_repository_bucket + "/ECS765/ethereum-parvulus/contracts.csv") lines.filter(good_line) lines
= lines.map(lambda
l: (csv_split(l)[0], csv_split(l)[2], csv_split(l)[3], csv_split(l)[4], csv_split(l)[5])) print(lines.take(10)) spark.stop()

​

Notion uses cookies. See [Cookie
Notice](https://www.notion.so/Cookie-Notice-bc186044eed5488a8387a9e94b14e58c?pvs=21) for details.

**Accept all**

**Reject all**

[data:image/svg+xml;base64,PHN2ZyByb2xlPSJncmFwaGljcy1zeW1ib2wiIHZpZXdib3g9IjAgMCAxMyAzIiBjbGFzcz0iZG90cyIgc3R5bGU9IndpZHRoOiAxNHB4OyBoZWlnaHQ6IDEwMCU7IGRpc3BsYXk6IGJsb2NrOyBmaWxsOiByZ2IoMjUsIDI1LCAyNSk7IGZsZXgtc2hyaW5rOiAwOyBtYXJnaW4tbGVmdDogNHB4OyI+PGc+PHBhdGggZD0iTTMsMS41QTEuNSwxLjUsMCwxLDEsMS41LDAsMS41LDEuNSwwLDAsMSwzLDEuNVoiIC8+PHBhdGggZD0iTTgsMS41QTEuNSwxLjUsMCwxLDEsNi41LDAsMS41LDEuNSwwLDAsMSw4LDEuNVoiIC8+PHBhdGggZD0iTTEzLDEuNUExLjUsMS41LDAsMSwxLDExLjUsMCwxLjUsMS41LDAsMCwxLDEzLDEuNVoiIC8+PC9nPjwvc3ZnPg==](data:image/svg+xml;base64,PHN2ZyByb2xlPSJncmFwaGljcy1zeW1ib2wiIHZpZXdib3g9IjAgMCAxMyAzIiBjbGFzcz0iZG90cyIgc3R5bGU9IndpZHRoOiAxNHB4OyBoZWlnaHQ6IDEwMCU7IGRpc3BsYXk6IGJsb2NrOyBmaWxsOiByZ2IoMjUsIDI1LCAyNSk7IGZsZXgtc2hyaW5rOiAwOyBtYXJnaW4tbGVmdDogNHB4OyI+PGc+PHBhdGggZD0iTTMsMS41QTEuNSwxLjUsMCwxLDEsMS41LDAsMS41LDEuNSwwLDAsMSwzLDEuNVoiIC8+PHBhdGggZD0iTTgsMS41QTEuNSwxLjUsMCwxLDEsNi41LDAsMS41LDEuNSwwLDAsMSw4LDEuNVoiIC8+PHBhdGggZD0iTTEzLDEuNUExLjUsMS41LDAsMSwxLDExLjUsMCwxLjUsMS41LDAsMCwxLDEzLDEuNVoiIC8+PC9nPjwvc3ZnPg==)